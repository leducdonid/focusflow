@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

/* ==================== THEME SYSTEM ==================== */

/* Default (dark) theme — also applies via [data-theme="dark"] */
:root,
[data-theme="dark"] {
  --bg: #0a0f0d;
  --bg-2: #111916;
  --surface: #1a2420;
  --surface-2: #243029;
  --border: #2d3b33;
  --border-light: #3d4f44;
  --accent: #d4b872;
  --accent-2: #5a9e76;
  --accent-warm: #b8885a;
  --accent-soft: #8ba37a;
  --text: #f2ede4;
  --text-secondary: #b8b3aa;
  --text-muted: #7a756c;
  --shadow: rgba(0, 0, 0, 0.4);
  --nav-width: 240px;

  /* Theme-specific background pattern colors */
  --grid-line: rgba(45, 59, 51, 0.5);
  --glow-accent: rgba(212, 184, 114, 0.08);
  --glow-green: rgba(90, 158, 118, 0.06);
  --gantt-axis-bg: rgba(45, 59, 51, 0.5);
  --toast-shadow: rgba(0, 0, 0, 0.4);
  --modal-backdrop: rgba(0, 0, 0, 0.75);
  --color-scheme: dark;
}

/* Light theme */
[data-theme="light"] {
  --bg: #f5f2ec;
  --bg-2: #ebe7df;
  --surface: #ffffff;
  --surface-2: #f0ece5;
  --border: #d6d0c4;
  --border-light: #c4bdb0;
  --accent: #9a7b2f;
  --accent-2: #3a7d54;
  --accent-warm: #9e6b32;
  --accent-soft: #5f7a50;
  --text: #1a1813;
  --text-secondary: #4a463e;
  --text-muted: #8a847a;
  --shadow: rgba(0, 0, 0, 0.1);

  --grid-line: rgba(180, 170, 155, 0.3);
  --glow-accent: rgba(154, 123, 47, 0.05);
  --glow-green: rgba(58, 125, 84, 0.04);
  --gantt-axis-bg: rgba(180, 170, 155, 0.25);
  --toast-shadow: rgba(0, 0, 0, 0.12);
  --modal-backdrop: rgba(0, 0, 0, 0.4);
  --color-scheme: light;
}

/* Smooth theme transition — disabled during initial load via [data-no-transition] */
body:not([data-no-transition]),
body:not([data-no-transition]) .nav-sidebar,
body:not([data-no-transition]) .main-content,
body:not([data-no-transition]) .nav-brand__mark,
body:not([data-no-transition]) .nav-item,
body:not([data-no-transition]) .nav-progress__ring span,
body:not([data-no-transition]) .nav-credit,
body:not([data-no-transition]) .home-card,
body:not([data-no-transition]) .home-action-card,
body:not([data-no-transition]) .analytics-card,
body:not([data-no-transition]) .analytics-section,
body:not([data-no-transition]) .task-add-card,
body:not([data-no-transition]) .matrix-quadrant,
body:not([data-no-transition]) .task-item,
body:not([data-no-transition]) .timer-focus-panel,
body:not([data-no-transition]) .timer-blocks-panel,
body:not([data-no-transition]) .block-tasks-bar,
body:not([data-no-transition]) .block-schedule-full,
body:not([data-no-transition]) .gantt-container-full,
body:not([data-no-transition]) .settings-group,
body:not([data-no-transition]) .guide-section,
body:not([data-no-transition]) .guide-step,
body:not([data-no-transition]) .guide-tip-card,
body:not([data-no-transition]) .modal__content,
body:not([data-no-transition]) .toast,
body:not([data-no-transition]) .btn,
body:not([data-no-transition]) input,
body:not([data-no-transition]) select {
  transition:
    background-color 250ms ease,
    border-color 250ms ease,
    color 250ms ease,
    box-shadow 250ms ease;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: "Inter", system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  line-height: 1.5;
  color-scheme: var(--color-scheme);
}

/* ==================== APP SHELL ==================== */
.app-shell {
  display: grid;
  grid-template-columns: var(--nav-width) 1fr;
  min-height: 100vh;
}

/* ==================== NAVIGATION SIDEBAR ==================== */
.nav-sidebar {
  background: var(--bg-2);
  border-right: 1px solid var(--border);
  padding: 24px 16px;
  display: flex;
  flex-direction: column;
  position: sticky;
  top: 0;
  height: 100vh;
  overflow-y: auto;
}

.nav-brand {
  display: flex;
  align-items: center;
  gap: 12px;
  padding-bottom: 24px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 24px;
}

.nav-brand__mark {
  width: 40px;
  height: 40px;
  border-radius: 12px;
  background: var(--accent);
  color: var(--bg);
  display: grid;
  place-items: center;
  font-weight: 700;
  font-size: 0.9rem;
  letter-spacing: 0.05em;
}

.nav-brand__text h1 {
  font-size: 1.1rem;
  font-weight: 600;
}

.nav-date {
  font-size: 0.75rem;
  color: var(--text-muted);
}

.nav-menu {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
}

/* Nav Section Labels */
.nav-section-label {
  font-size: 0.65rem;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--text-muted);
  padding: 16px 14px 8px;
  margin-top: 8px;
}

.nav-section-label:first-child {
  margin-top: 0;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 12px 14px;
  border: none;
  border-radius: 12px;
  background: transparent;
  color: var(--text-secondary);
  font-size: 0.9rem;
  font-family: inherit;
  cursor: pointer;
  transition: all 150ms ease;
  text-align: left;
}

.nav-item:hover {
  background: var(--surface);
  color: var(--text);
}

.nav-item.is-active {
  background: var(--surface-2);
  color: var(--text);
}

.nav-item.is-active .nav-icon {
  transform: scale(1.1);
}

/* Flow Step Numbers in Nav */
.nav-item--flow {
  position: relative;
}

.nav-step {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--border);
  color: var(--text-muted);
  font-size: 0.65rem;
  font-weight: 600;
  display: grid;
  place-items: center;
  flex-shrink: 0;
}

.nav-item--flow.is-active .nav-step {
  background: var(--accent);
  color: var(--bg);
}

.nav-item--flow.is-done .nav-step {
  background: var(--accent-2);
  color: var(--bg);
}

.nav-item--flow.is-done .nav-step::after {
  content: "✓";
  font-size: 0.6rem;
}

.nav-icon {
  font-size: 1.1rem;
  transition: transform 150ms ease;
}

.nav-label {
  flex: 1;
}

.nav-badge {
  background: var(--accent);
  color: var(--bg);
  font-size: 0.7rem;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 999px;
  min-width: 24px;
  text-align: center;
}

.nav-badge:empty {
  display: none;
}

/* Nav Progress */
.nav-progress {
  margin-top: auto;
  padding-top: 20px;
  border-top: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 12px;
}

.nav-progress__ring {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: conic-gradient(var(--accent-2) var(--progress), var(--border) 0);
  display: grid;
  place-items: center;
  flex-shrink: 0;
  transition: background 600ms cubic-bezier(0.4, 0, 0.2, 1);
}

.nav-progress__ring span {
  width: 34px;
  height: 34px;
  border-radius: 50%;
  background: var(--bg-2);
  display: grid;
  place-items: center;
  font-size: 0.7rem;
  font-weight: 600;
}

.nav-progress__label {
  font-size: 0.75rem;
  color: var(--text-muted);
}

/* Nav Credit */
.nav-credit {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
  text-align: center;
}

.nav-credit__text {
  font-size: 0.65rem;
  color: var(--text-muted);
  display: block;
  margin-bottom: 2px;
}

.nav-credit__brand {
  font-size: 0.75rem;
  font-weight: 600;
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: 0.02em;
}

/* ==================== MAIN CONTENT ==================== */
.main-content {
  grid-column: 2;
  padding: 32px 48px;
  min-height: 100vh;
  background:
    /* Grid pattern */
    linear-gradient(var(--grid-line) 1px, transparent 1px),
    linear-gradient(90deg, var(--grid-line) 1px, transparent 1px),
    /* Glow effects */
    radial-gradient(900px 600px at 75% 5%, var(--glow-accent), transparent 60%),
    radial-gradient(700px 500px at 25% 85%, var(--glow-green), transparent 60%),
    var(--bg);
  background-size:
    60px 60px,
    60px 60px,
    100% 100%,
    100% 100%,
    100% 100%;
}

/* ==================== VIEWS ==================== */
.view {
  display: none;
  opacity: 0;
  transform: translateY(12px);
}

.view.is-active {
  display: block;
  animation: viewEnter 350ms cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

.view.is-exiting {
  display: block;
  animation: viewExit 200ms cubic-bezier(0.4, 0, 1, 1) forwards;
}

@keyframes viewEnter {
  from { opacity: 0; transform: translateY(12px) scale(0.99); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes viewExit {
  from { opacity: 1; transform: translateY(0) scale(1); }
  to { opacity: 0; transform: translateY(-8px) scale(0.99); }
}

/* Legacy fadeIn kept for other elements */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.view-header {
  margin-bottom: 28px;
}

.view-header__top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.view-header h2 {
  font-size: 1.6rem;
  font-weight: 700;
  margin-bottom: 8px;
  letter-spacing: -0.02em;
}

.view-desc {
  color: var(--text-muted);
  font-size: 0.9rem;
}

/* Step Badge - Nâng cấp */
.view-step-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 14px;
  border-radius: 999px;
  background: rgba(212, 184, 114, 0.12);
  border: 1px solid rgba(212, 184, 114, 0.25);
  color: var(--accent);
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.view-step-badge__icon {
  font-size: 1rem;
}

.view-step-badge--flow2 {
  background: rgba(90, 158, 118, 0.12);
  border-color: rgba(90, 158, 118, 0.25);
  color: var(--accent-2);
}

.view-step-badge--flow3 {
  background: rgba(229, 115, 115, 0.12);
  border-color: rgba(229, 115, 115, 0.25);
  color: #e57373;
}

.view-step-badge--home {
  background: rgba(139, 163, 122, 0.12);
  border-color: rgba(139, 163, 122, 0.25);
  color: var(--accent-soft);
}

.view-step-badge--analytics {
  background: rgba(147, 112, 219, 0.12);
  border-color: rgba(147, 112, 219, 0.25);
  color: #9370db;
}

/* Flow Next Button */
.flow-next-btn {
  animation: fadeSlideIn 300ms ease;
}

.flow-next-btn[hidden] {
  display: none;
}

@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateX(10px); }
  to { opacity: 1; transform: translateX(0); }
}

.btn--accent {
  background: linear-gradient(135deg, var(--accent-2), rgba(90, 158, 118, 0.8));
  border: none;
  color: var(--bg);
  font-weight: 600;
}

.btn--accent:hover {
  transform: translateX(2px);
  box-shadow: 0 4px 12px rgba(90, 158, 118, 0.3);
}

.btn__arrow {
  margin-left: 4px;
  transition: transform 150ms ease;
}

.btn--accent:hover .btn__arrow {
  transform: translateX(3px);
}

.btn--outline {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-secondary);
}

.btn--outline:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.btn--icon {
  width: 44px;
  height: 44px;
  padding: 0;
  border-radius: 12px;
  font-size: 1.2rem;
  display: grid;
  place-items: center;
}

/* Legacy Next Step Hint */
.next-step-hint {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  padding: 12px 16px;
  margin-bottom: 20px;
  background: rgba(90, 158, 118, 0.1);
  border: 1px solid rgba(90, 158, 118, 0.25);
  border-radius: 12px;
  color: var(--accent-2);
  font-size: 0.85rem;
}

.next-step-hint span {
  font-weight: 500;
}

.next-step-hint[hidden] {
  display: none;
}

/* ==================== HOME (DASHBOARD) ==================== */

/* Home Actions */
.home-actions {
  margin-bottom: 24px;
}

.home-action-card {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px 24px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  cursor: pointer;
  transition: all 150ms ease;
}

.home-action-card:hover {
  border-color: var(--accent);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
}

.home-action-card--primary {
  background: linear-gradient(135deg, var(--surface), rgba(212, 184, 114, 0.08));
  border-color: rgba(212, 184, 114, 0.3);
}

.home-action-card__icon {
  font-size: 2rem;
  flex-shrink: 0;
}

.home-action-card__content {
  flex: 1;
}

.home-action-card__content h4 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 4px;
}

.home-action-card__content p {
  font-size: 0.85rem;
  color: var(--text-muted);
}

.home-action-card__arrow {
  font-size: 1.5rem;
  color: var(--accent);
  transition: transform 150ms ease;
}

.home-action-card:hover .home-action-card__arrow {
  transform: translateX(4px);
}

/* Home Grid */
.home-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

.home-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 20px;
}

.home-card--wide {
  grid-column: span 2;
}

.home-card__header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

.home-card__icon {
  font-size: 1rem;
}

.home-card__label {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
}

.home-card__value {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 4px;
  line-height: 1.4;
}

.home-card__meta {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 12px;
}

/* Home Progress */
.home-progress {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 24px;
  padding: 8px 0;
}

.home-progress__item {
  text-align: center;
}

.home-progress__value {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--accent);
  display: block;
}

.home-progress__label {
  font-size: 0.75rem;
  color: var(--text-muted);
}

.home-progress__divider {
  width: 1px;
  height: 40px;
  background: var(--border);
}

/* Home Section */
.home-section {
  margin-top: 24px;
}

.home-section__header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

.home-section__icon {
  font-size: 1rem;
}

.home-section__header h3 {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-secondary);
}

/* ==================== ANALYTICS ==================== */

/* Analytics Grid */
.analytics-grid {
  display: grid;
  grid-template-columns: 1.2fr repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

.analytics-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 20px;
}

.analytics-card--goal {
  grid-row: span 2;
  display: flex;
  flex-direction: column;
}

.analytics-card--streak {
  background: linear-gradient(135deg, var(--surface), rgba(229, 115, 115, 0.08));
  border-color: rgba(229, 115, 115, 0.2);
}

.analytics-card__header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
}

.analytics-card__icon {
  font-size: 1rem;
}

.analytics-card__title {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--text-muted);
  font-weight: 500;
}

.analytics-card__content {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.analytics-card__value {
  text-align: center;
}

.analytics-number {
  font-size: 2.2rem;
  font-weight: 700;
  color: var(--accent);
  display: block;
  line-height: 1;
  margin-bottom: 4px;
}

.analytics-unit {
  font-size: 0.8rem;
  color: var(--text-muted);
}

/* Analytics Section */
.analytics-section {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 20px;
  margin-bottom: 20px;
}

.analytics-section__header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.analytics-section__icon {
  font-size: 1rem;
}

.analytics-section__header h3 {
  font-size: 0.9rem;
  font-weight: 600;
  margin: 0;
}

.analytics-section__summary {
  text-align: center;
  margin-top: 12px;
  font-size: 0.85rem;
  color: var(--text-muted);
}

/* ==================== LEGACY DASHBOARD ==================== */

/* Flow Guide */
.flow-guide {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 24px;
  padding: 16px 20px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
}

.flow-step {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: 999px;
  background: transparent;
  color: var(--text-muted);
  font-size: 0.85rem;
  transition: all 150ms ease;
}

.flow-step::after {
  content: "→";
  margin-left: 8px;
  color: var(--border-light);
}

.flow-step:last-child::after {
  display: none;
}

.flow-step--active {
  background: rgba(212, 184, 114, 0.15);
  color: var(--accent);
}

.flow-step--done {
  color: var(--accent-2);
}

.flow-step--done .flow-step__number {
  background: var(--accent-2);
}

.flow-step__number {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: var(--border);
  color: var(--bg);
  font-size: 0.7rem;
  font-weight: 600;
  display: grid;
  place-items: center;
}

.flow-step--active .flow-step__number {
  background: var(--accent);
}

/* Next Action Card */
.next-action-card {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 24px;
  margin-bottom: 24px;
  background: linear-gradient(135deg, var(--surface), rgba(212, 184, 114, 0.1));
  border: 1px solid rgba(212, 184, 114, 0.3);
  border-radius: 16px;
}

.next-action__icon {
  font-size: 2rem;
  flex-shrink: 0;
}

.next-action__content {
  flex: 1;
}

.next-action__content h3 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 4px;
}

.next-action__content p {
  font-size: 0.85rem;
  color: var(--text-muted);
}

.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 32px;
}

.dash-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 24px;
  min-width: 0;
}

.dash-card h3 {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-muted);
  margin-bottom: 16px;
  white-space: nowrap;
}

.dash-card--highlight {
  border-color: rgba(212, 184, 114, 0.3);
  background: linear-gradient(135deg, var(--surface), rgba(212, 184, 114, 0.08));
}

.dash-value {
  font-size: 1.05rem;
  font-weight: 600;
  margin-bottom: 6px;
  line-height: 1.4;
  word-wrap: break-word;
}

.dash-meta {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 16px;
}

.dash-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  text-align: center;
}

.dash-stat__value {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--accent);
  display: block;
}

.dash-stat__label {
  font-size: 0.75rem;
  color: var(--text-muted);
}

.dash-section {
  margin-top: 24px;
}

.dash-section h3 {
  font-size: 0.9rem;
  font-weight: 500;
  margin-bottom: 12px;
  color: var(--text-secondary);
}

.recent-list {
  list-style: none;
  display: grid;
  gap: 8px;
}

.recent-list li {
  padding: 12px 16px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.recent-item {
  display: flex;
  align-items: center;
  gap: 12px;
}

.recent-icon {
  font-size: 1rem;
  flex-shrink: 0;
}

.recent-time {
  font-weight: 500;
  color: var(--text);
  min-width: 50px;
}

.recent-label {
  color: var(--text-muted);
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ==================== TASKS ==================== */

/* Task Add Card - Nâng cấp */
.task-add-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px 24px;
  margin-bottom: 24px;
}

.task-add-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.task-add-header__icon {
  font-size: 1rem;
}

.task-add-header__text {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.task-add-main {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 14px;
}

.task-add-input {
  flex: 1;
  padding: 14px 18px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 1rem;
  font-family: inherit;
  transition: all 150ms ease;
}

.task-add-input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(212, 184, 114, 0.1);
}

.task-add-input::placeholder {
  color: var(--text-muted);
}

.task-add-options-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.task-add-hint {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-style: italic;
}

.task-add-options {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  flex-wrap: wrap;
}

.task-add-option {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.85rem;
  color: var(--text-muted);
}

.task-add-option__label {
  color: var(--text-secondary);
}

.task-add-time {
  width: 60px;
  padding: 8px 10px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 0.85rem;
  font-family: inherit;
  text-align: center;
}

.task-add-time:focus {
  outline: none;
  border-color: var(--accent);
}

.task-add-option__unit {
  color: var(--text-muted);
}

.task-add-toggles {
  display: flex;
  gap: 10px;
}

.toggle-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 10px 16px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  font-size: 0.8rem;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 150ms ease;
}

.toggle-chip input {
  display: none;
}

.toggle-chip__icon {
  font-size: 0.9rem;
}

.toggle-chip__label {
  font-weight: 500;
}

.toggle-chip:hover {
  border-color: var(--text-muted);
  color: var(--text);
  transform: translateY(-1px);
}

.toggle-chip--important:has(input:checked) {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.15);
  color: var(--accent);
  box-shadow: 0 2px 8px rgba(212, 184, 114, 0.2);
}

.toggle-chip--urgent:has(input:checked) {
  border-color: var(--accent-warm);
  background: rgba(232, 178, 124, 0.15);
  color: var(--accent-warm);
  box-shadow: 0 2px 8px rgba(232, 178, 124, 0.2);
}

/* Legacy toggle */
.toggle-chip:has(input:checked) {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.15);
  color: var(--accent);
}

/* Ma trận Eisenhower - Nâng cấp với labels */
.matrix-wrapper {
  margin-bottom: 20px;
}

.matrix-labels {
  display: grid;
  gap: 16px;
}

.matrix-labels--top {
  grid-template-columns: 30px 1fr 1fr;
  margin-bottom: 8px;
  padding-left: 4px;
}

.matrix-label {
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--accent);
  text-align: center;
}

.matrix-label--muted {
  color: var(--text-muted);
  font-weight: 400;
}

.matrix-with-labels {
  display: grid;
  grid-template-columns: 30px 1fr;
  gap: 8px;
}

.matrix-labels--left {
  display: flex;
  flex-direction: column;
  justify-content: space-around;
  padding: 20px 0;
}

.matrix-labels--left .matrix-label {
  writing-mode: vertical-lr;
  transform: rotate(180deg);
  text-align: center;
}

/* Ma trận Eisenhower - Layout 2x2 */
.matrix-eisenhower {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  margin-bottom: 20px;
}

/* Ẩn row/col labels - không cần thiết */
.matrix-row-label,
.matrix-col-label {
  display: none;
}

/* Quadrants */
.matrix-quadrant {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 16px;
  min-height: 200px;
  display: flex;
  flex-direction: column;
}

.matrix-quadrant--do {
  border-top: 3px solid #e57373;
}

.matrix-quadrant--schedule {
  border-top: 3px solid var(--accent);
}

.matrix-quadrant--delegate {
  border-top: 3px solid var(--accent-warm);
}

.matrix-quadrant--eliminate {
  border-top: 3px solid var(--text-muted);
}

.matrix-quadrant__header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 4px;
}

.matrix-quadrant__badge {
  width: 22px;
  height: 22px;
  border-radius: 6px;
  background: var(--bg-2);
  color: var(--text-muted);
  font-size: 0.7rem;
  font-weight: 700;
  display: grid;
  place-items: center;
}

.matrix-quadrant--do .matrix-quadrant__badge {
  background: rgba(229, 115, 115, 0.15);
  color: #e57373;
}

.matrix-quadrant--schedule .matrix-quadrant__badge {
  background: rgba(212, 184, 114, 0.15);
  color: var(--accent);
}

.matrix-quadrant--delegate .matrix-quadrant__badge {
  background: rgba(232, 178, 124, 0.15);
  color: var(--accent-warm);
}

.matrix-quadrant__header h3 {
  font-size: 0.9rem;
  font-weight: 600;
  margin: 0;
}

.matrix-quadrant__desc {
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-bottom: 12px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.matrix-quadrant .task-list {
  flex: 1;
}

/* Task List */
.task-list {
  list-style: none;
  display: grid;
  gap: 8px;
}

.task-item {
  position: relative;
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 14px 16px;
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 12px;
  transition: all 150ms ease;
  cursor: grab;
}

.task-item:hover {
  border-color: rgba(212, 184, 114, 0.3);
}

/* Drag & Drop States */
.task-item.is-dragging {
  opacity: 0.5;
  cursor: grabbing;
}

.task-item.drag-ghost {
  position: fixed;
  pointer-events: none;
  z-index: 1000;
  opacity: 0.9;
  transform: rotate(3deg);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
}

.task-list.drag-over {
  background: rgba(212, 184, 114, 0.08);
  border-radius: 8px;
}

.matrix-quadrant.drag-over {
  border-color: var(--accent) !important;
  background: rgba(212, 184, 114, 0.05);
}

.matrix-quadrant.drag-over::after {
  content: "Thả vào đây";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  padding: 8px 16px;
  background: var(--accent);
  color: var(--bg);
  border-radius: 8px;
  font-size: 0.8rem;
  font-weight: 500;
  opacity: 0.9;
  pointer-events: none;
}

.task-item.is-done {
  opacity: 0.5;
}

.task-item.is-done .task-item__title {
  text-decoration: line-through;
}

.task-item__checkbox {
  width: 20px;
  height: 20px;
  margin-top: 2px;
  accent-color: var(--accent-2);
  cursor: pointer;
  flex-shrink: 0;
}

.task-item__content {
  flex: 1;
  min-width: 0;
}

.task-item__title {
  font-size: 0.9rem;
  line-height: 1.4;
  margin-bottom: 4px;
  word-break: break-word;
}

.task-item__meta {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.75rem;
  color: var(--text-muted);
}

.task-item__time {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.task-item__badge {
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 0.65rem;
  font-weight: 500;
}

.task-item__badge--important {
  background: rgba(212, 184, 114, 0.15);
  color: var(--accent);
}

.task-item__badge--urgent {
  background: rgba(232, 178, 124, 0.15);
  color: var(--accent-warm);
}

.task-item__badge--scheduled {
  background: rgba(90, 158, 118, 0.15);
  color: var(--accent-2);
}

.task-item__actions {
  display: flex;
  gap: 4px;
  opacity: 0;
  transition: opacity 150ms ease;
}

.task-item:hover .task-item__actions {
  opacity: 1;
}

.task-item__btn {
  width: 32px;
  height: 32px;
  border: none;
  border-radius: 8px;
  background: transparent;
  color: var(--text-muted);
  font-size: 0.85rem;
  cursor: pointer;
  display: grid;
  place-items: center;
  transition: all 150ms ease;
}

.task-item__btn:hover {
  background: var(--surface);
  color: var(--text);
}

.task-item__btn--schedule {
  color: var(--accent);
}

.task-item__btn--schedule:hover {
  background: rgba(212, 184, 114, 0.15);
  color: var(--accent);
}

.task-item__btn--delete:hover {
  background: rgba(232, 178, 124, 0.15);
  color: var(--accent-warm);
}

.task-item__btn--edit:hover {
  background: rgba(90, 158, 118, 0.15);
  color: var(--accent-2);
}

/* Task Footer */
.task-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 20px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

.task-footer__meta {
  font-size: 0.85rem;
  color: var(--text-muted);
}

/* Empty state */
.task-empty {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-muted);
}

.task-empty--small {
  padding: 20px 12px;
}

.task-empty__icon {
  font-size: 2rem;
  margin-bottom: 12px;
  opacity: 0.5;
}

.task-empty__text {
  font-size: 0.9rem;
}

.task-empty--small .task-empty__text {
  font-size: 0.8rem;
  font-style: italic;
  opacity: 0.7;
}

/* Legacy styles for compatibility */
.matrix-item {
  position: relative;
  padding: 10px 12px;
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 10px;
}

.matrix-item.done {
  opacity: 0.5;
}

.matrix-item.is-active {
  border-color: var(--accent-2);
  background: rgba(90, 158, 118, 0.1);
}

.matrix-item__row {
  display: flex;
  align-items: center;
  gap: 10px;
}

.matrix-item input[type="checkbox"] {
  width: 18px;
  height: 18px;
  accent-color: var(--accent-2);
}

.matrix-title {
  flex: 1;
  font-size: 0.9rem;
}

.focus-now-btn {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  border: 1px solid rgba(212, 184, 114, 0.4);
  background: rgba(212, 184, 114, 0.1);
  color: var(--accent);
  font-size: 0.65rem;
  cursor: pointer;
  display: grid;
  place-items: center;
  transition: all 150ms ease;
}

.focus-now-btn:hover {
  background: var(--accent);
  color: var(--bg);
}

.matrix-meta {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: 6px;
}

.matrix-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 8px;
}

.flag-btn {
  padding: 3px 8px;
  border: 1px solid var(--border);
  border-radius: 999px;
  background: transparent;
  color: var(--text-muted);
  font-size: 0.7rem;
  cursor: pointer;
}

.flag-btn.is-active {
  border-color: var(--accent-2);
  color: var(--accent-2);
}

.flag-btn.urgent.is-active {
  border-color: var(--accent-warm);
  color: var(--accent-warm);
}

.plan-btn {
  padding: 3px 8px;
  border: 1px solid rgba(212, 184, 114, 0.3);
  border-radius: 999px;
  background: transparent;
  color: var(--accent);
  font-size: 0.7rem;
  cursor: pointer;
}

.plan-btn.is-scheduled {
  border-color: var(--accent-2);
  color: var(--accent-2);
  cursor: default;
  opacity: 0.7;
}

.task-linked-block {
  color: var(--accent);
  font-weight: 500;
}

.delete-btn {
  padding: 3px 8px;
  border: none;
  background: none;
  color: var(--accent-warm);
  font-size: 0.7rem;
  cursor: pointer;
}

.task-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 20px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

/* ==================== TIMER ==================== */

/* Timer Layout */
.timer-layout {
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 24px;
  align-items: start;
}

/* Timer Main */
.timer-main {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 40px;
  text-align: center;
}

.timer-context-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  margin-bottom: 24px;
  background: rgba(212, 184, 114, 0.08);
  border: 1px solid rgba(212, 184, 114, 0.2);
  border-radius: 12px;
  text-align: left;
}

.timer-context__icon {
  font-size: 1.5rem;
}

.timer-context__info {
  flex: 1;
}

.timer-context__label {
  display: block;
  font-size: 0.7rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 2px;
}

.timer-context__task {
  font-weight: 600;
  font-size: 1rem;
  color: var(--accent);
}

.timer-display-wrapper {
  margin-bottom: 24px;
}

.timer-ring-wrapper {
  position: relative;
  width: 200px;
  height: 200px;
  margin: 0 auto;
}

.timer-ring {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
}

.timer-ring__bg {
  fill: none;
  stroke: var(--border);
  stroke-width: 4;
}

.timer-ring__progress {
  fill: none;
  stroke: var(--accent-2);
  stroke-width: 4;
  stroke-linecap: round;
  stroke-dasharray: 283;
  stroke-dashoffset: 283;
  transition: stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1);
}

.timer-ring-wrapper .timer-display {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Timer Sidebar */
.timer-sidebar {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  max-height: 500px;
  overflow-y: auto;
}

.timer-sidebar__header {
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.timer-sidebar__header h3 {
  font-size: 0.9rem;
  font-weight: 600;
  margin: 0;
}

.timer-work-options {
  display: grid;
  gap: 8px;
}

.timer-work-option {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 14px;
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 10px;
  cursor: pointer;
  transition: all 150ms ease;
  text-align: left;
  width: 100%;
  font-family: inherit;
  color: var(--text);
}

.timer-work-option:hover {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.05);
}

.timer-work-option.is-selected {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.1);
}

.timer-work-option__icon {
  font-size: 1rem;
}

.timer-work-option__info {
  flex: 1;
  min-width: 0;
}

.timer-work-option__title {
  font-weight: 500;
  font-size: 0.85rem;
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.timer-work-option__meta {
  font-size: 0.7rem;
  color: var(--text-muted);
}

.timer-work-option__badge {
  font-size: 0.65rem;
  padding: 2px 6px;
  border-radius: 999px;
  background: rgba(90, 158, 118, 0.15);
  color: var(--accent-2);
  flex-shrink: 0;
}

.timer-work-option__badge--block {
  background: rgba(212, 184, 114, 0.15);
  color: var(--accent);
}

.timer-work-option__linked {
  display: block;
  font-size: 0.65rem;
  color: var(--accent-2);
  margin-top: 2px;
}

.timer-work-separator {
  text-align: center;
  padding: 8px 0;
  color: var(--text-muted);
  font-size: 0.7rem;
}

.timer-work-separator span {
  background: var(--surface);
  padding: 0 8px;
}

.timer-empty {
  text-align: center;
  padding: 30px 16px;
  color: var(--text-muted);
}

.timer-empty__icon {
  font-size: 2rem;
  display: block;
  margin-bottom: 8px;
  opacity: 0.5;
}

.timer-empty__text {
  display: block;
  margin-bottom: 12px;
  font-size: 0.85rem;
}

/* Legacy */
.timer-container {
  max-width: 480px;
  margin: 0 auto;
  text-align: center;
  padding: 40px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 24px;
}

.timer-mode {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
}

#mode-label {
  color: var(--text-secondary);
  font-size: 0.9rem;
}

.timer-chip {
  padding: 4px 12px;
  border: 1px solid var(--border);
  border-radius: 999px;
  font-size: 0.75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.timer-display {
  font-size: 5rem;
  font-weight: 600;
  letter-spacing: 0.02em;
  margin-bottom: 16px;
  font-variant-numeric: tabular-nums;
}

.timer-context {
  margin-bottom: 20px;
  padding: 12px 16px;
  background: var(--bg-2);
  border-radius: 10px;
}

.timer-context__label {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-right: 8px;
}

.timer-context__task {
  font-weight: 500;
  color: var(--accent);
}

.timer-presets {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 24px;
}

.preset-btn {
  padding: 8px 16px;
  border: 1px solid var(--border);
  border-radius: 999px;
  background: transparent;
  color: var(--text-secondary);
  font-size: 0.85rem;
  cursor: pointer;
  transition: all 150ms ease;
}

.preset-btn:hover {
  border-color: var(--border-light);
}

.preset-btn.is-active {
  background: var(--accent);
  color: var(--bg);
  border-color: var(--accent);
}

.timer-controls {
  display: flex;
  justify-content: center;
  gap: 12px;
}

/* Timer Flow Layout - 2 columns like Flow 2 */
.timer-flow-layout {
  display: grid;
  grid-template-columns: 1fr 1.2fr;
  gap: 24px;
  align-items: start;
}

/* Timer Blocks Panel (left) */
.timer-blocks-panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  max-height: 500px;
  overflow-y: auto;
}

.timer-panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.timer-panel-title {
  display: flex;
  align-items: center;
  gap: 8px;
}

.timer-panel-icon {
  font-size: 1rem;
}

.timer-panel-header h3 {
  font-size: 0.9rem;
  font-weight: 600;
  margin: 0;
}

.timer-panel-hint {
  font-size: 0.7rem;
  color: var(--text-muted);
  background: var(--bg-2);
  padding: 4px 10px;
  border-radius: 999px;
}

.timer-block-list {
  display: grid;
  gap: 8px;
}

/* Timer Focus Panel (right) */
.timer-focus-panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 40px;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.timer-focus-panel::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #e57373, var(--accent-warm), var(--accent));
  opacity: 0.8;
}

/* Empty Blocks State - Nâng cấp */
.timer-empty-blocks {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-muted);
}

.timer-empty-blocks[hidden] {
  display: none;
}

.timer-empty-blocks__content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.timer-empty-blocks__icon {
  font-size: 2.5rem;
  opacity: 0.4;
}

.timer-empty-blocks__title {
  font-size: 0.95rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.timer-empty-blocks__text {
  font-size: 0.8rem;
  margin-bottom: 8px;
}

/* ==================== BLOCKS ==================== */

/* Block Layout - 2 columns (Legacy) */
.block-layout {
  display: grid;
  grid-template-columns: 1fr 1.2fr;
  gap: 24px;
  align-items: start;
}

/* ==================== NEW VERTICAL LAYOUT ==================== */
.block-layout-vertical {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* Task Bar (Top) */
.block-tasks-bar {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 16px 20px;
}

.block-tasks-bar__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.block-tasks-bar__title {
  display: flex;
  align-items: center;
  gap: 10px;
}

.block-tasks-bar__icon {
  font-size: 1rem;
}

.block-tasks-bar__title h3 {
  font-size: 0.9rem;
  font-weight: 600;
  margin: 0;
}

.block-tasks-bar__hint {
  font-size: 0.7rem;
  color: var(--text-muted);
  background: var(--bg-2);
  padding: 4px 10px;
  border-radius: 999px;
}

.block-tasks-bar__content {
  min-height: 60px;
}

.block-tasks-bar__empty {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 16px;
  color: var(--text-muted);
  font-size: 0.85rem;
}

/* Horizontal Task List */
.block-tasks-horizontal {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding: 4px 0;
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

.block-tasks-horizontal::-webkit-scrollbar {
  height: 6px;
}

.block-tasks-horizontal::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

.block-task-chip {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 10px;
  min-width: 200px;
  max-width: 280px;
  flex-shrink: 0;
  transition: all 150ms ease;
  cursor: pointer;
}

.block-task-chip:hover {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.05);
  transform: translateY(-2px);
}

.block-task-chip__quadrant {
  font-size: 1rem;
}

.block-task-chip__content {
  flex: 1;
  min-width: 0;
}

.block-task-chip__title {
  font-size: 0.85rem;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-bottom: 2px;
}

.block-task-chip__meta {
  font-size: 0.7rem;
  color: var(--text-muted);
}

.block-task-chip__add {
  padding: 6px 10px;
  border: 1px solid var(--accent);
  border-radius: 6px;
  background: transparent;
  color: var(--accent);
  font-size: 0.7rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 150ms ease;
  white-space: nowrap;
}

.block-task-chip__add:hover {
  background: var(--accent);
  color: var(--bg);
}

.block-task-chip__icon {
  font-size: 1rem;
  flex-shrink: 0;
}

.block-task-chip__text {
  flex: 1;
  font-size: 0.85rem;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: left;
}

.block-task-chip__time {
  font-size: 0.7rem;
  color: var(--text-muted);
  padding: 2px 8px;
  background: var(--surface);
  border-radius: 999px;
  flex-shrink: 0;
}

/* Task chip priority variants */
.block-task-chip--do {
  border-color: rgba(229, 115, 115, 0.4);
  background: rgba(229, 115, 115, 0.08);
}

.block-task-chip--do:hover {
  border-color: #e57373;
  background: rgba(229, 115, 115, 0.12);
}

.block-task-chip--schedule {
  border-color: rgba(212, 184, 114, 0.4);
  background: rgba(212, 184, 114, 0.08);
}

.block-task-chip--schedule:hover {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.12);
}

/* Schedule Full Width */
.block-schedule-full {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 24px;
  position: relative;
  overflow: hidden;
}

.block-schedule-full::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--accent-2), var(--accent), var(--accent-warm));
  opacity: 0.8;
}

.block-schedule-full__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.block-schedule-full__title {
  display: flex;
  align-items: center;
  gap: 10px;
}

.block-schedule-full__icon {
  font-size: 1.2rem;
}

.block-schedule-full__title h3 {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 0;
}

.block-schedule-full__summary {
  font-size: 0.9rem;
  color: var(--accent-2);
  font-weight: 500;
}

/* Quick Add Bar */
.block-quick-add-bar {
  display: flex;
  align-items: flex-end;
  gap: 16px;
  padding: 16px 20px;
  background: var(--bg-2);
  border-radius: 12px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.block-quick-add-bar__field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.block-quick-add-bar__field--grow {
  flex: 1;
  min-width: 200px;
}

.block-quick-add-bar__field label {
  font-size: 0.65rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-muted);
  font-weight: 500;
}

.block-quick-add-bar__unit {
  position: absolute;
  right: 10px;
  bottom: 10px;
  font-size: 0.75rem;
  color: var(--text-muted);
}

.block-quick-add-bar__field:has(.block-quick-duration) {
  position: relative;
}

/* Color Picker - Popup Style */
.block-color-wrapper {
  position: relative;
}

.block-color-trigger {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  transition: all 150ms ease;
}

.block-color-trigger:hover {
  border-color: var(--accent);
}

.block-color-trigger__preview {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #22c55e;
}

.block-color-trigger__arrow {
  font-size: 0.6rem;
  color: var(--text-muted);
}

.block-color-popup {
  position: absolute;
  bottom: calc(100% + 8px);
  left: 0;
  z-index: 100;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  min-width: 200px;
}

.block-color-popup[hidden] {
  display: none;
}

.block-color-popup__grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
}

.block-color-btn {
  width: 32px;
  height: 32px;
  border-radius: 8px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 150ms ease;
}

.block-color-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.block-color-btn.is-active {
  border-color: var(--text);
  box-shadow: 0 0 0 2px var(--bg-2);
}

/* 20 Color Palette */
.block-color-btn[data-color="green"] { background: #22c55e; }
.block-color-btn[data-color="emerald"] { background: #10b981; }
.block-color-btn[data-color="teal"] { background: #14b8a6; }
.block-color-btn[data-color="cyan"] { background: #06b6d4; }
.block-color-btn[data-color="blue"] { background: #3b82f6; }
.block-color-btn[data-color="indigo"] { background: #6366f1; }
.block-color-btn[data-color="purple"] { background: #a855f7; }
.block-color-btn[data-color="violet"] { background: #8b5cf6; }
.block-color-btn[data-color="pink"] { background: #ec4899; }
.block-color-btn[data-color="rose"] { background: #f43f5e; }
.block-color-btn[data-color="red"] { background: #ef4444; }
.block-color-btn[data-color="orange"] { background: #f97316; }
.block-color-btn[data-color="amber"] { background: #f59e0b; }
.block-color-btn[data-color="yellow"] { background: #eab308; }
.block-color-btn[data-color="lime"] { background: #84cc16; }
.block-color-btn[data-color="brown"] { background: #a16207; }
.block-color-btn[data-color="stone"] { background: #78716c; }
.block-color-btn[data-color="slate"] { background: #64748b; }
.block-color-btn[data-color="zinc"] { background: #71717a; }
.block-color-btn[data-color="neutral"] { background: #737373; }

/* Gantt Full Width Container */
.gantt-container-full {
  background: var(--bg-2);
  border-radius: 14px;
  padding: 20px;
  margin-bottom: 20px;
}

.gantt-container-full .gantt-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.gantt-legend {
  display: flex;
  gap: 12px;
  margin-left: auto;
  flex-wrap: wrap;
}

.gantt-legend__item {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.7rem;
  color: var(--text-muted);
}


.gantt-timeline-full {
  position: relative;
  min-height: 200px;
  background: var(--surface);
  border-radius: 12px;
  overflow: hidden;
}

.gantt-timeline-full .gantt-time-axis {
  padding: 10px 16px;
}

.gantt-timeline-full .gantt-blocks {
  min-height: 160px;
  padding: 16px 16px 24px;
}

/* Block Colors in Gantt - 20 Colors with solid backgrounds */
.gantt-block--green { background: linear-gradient(135deg, #22c55e, #16a34a) !important; border-color: #15803d !important; }
.gantt-block--emerald { background: linear-gradient(135deg, #10b981, #059669) !important; border-color: #047857 !important; }
.gantt-block--teal { background: linear-gradient(135deg, #14b8a6, #0d9488) !important; border-color: #0f766e !important; }
.gantt-block--cyan { background: linear-gradient(135deg, #06b6d4, #0891b2) !important; border-color: #0e7490 !important; }
.gantt-block--blue { background: linear-gradient(135deg, #3b82f6, #2563eb) !important; border-color: #1d4ed8 !important; }
.gantt-block--indigo { background: linear-gradient(135deg, #6366f1, #4f46e5) !important; border-color: #4338ca !important; }
.gantt-block--purple { background: linear-gradient(135deg, #a855f7, #9333ea) !important; border-color: #7e22ce !important; }
.gantt-block--violet { background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important; border-color: #6d28d9 !important; }
.gantt-block--pink { background: linear-gradient(135deg, #ec4899, #db2777) !important; border-color: #be185d !important; }
.gantt-block--rose { background: linear-gradient(135deg, #f43f5e, #e11d48) !important; border-color: #be123c !important; }
.gantt-block--red { background: linear-gradient(135deg, #ef4444, #dc2626) !important; border-color: #b91c1c !important; }
.gantt-block--orange { background: linear-gradient(135deg, #f97316, #ea580c) !important; border-color: #c2410c !important; }
.gantt-block--amber { background: linear-gradient(135deg, #f59e0b, #d97706) !important; border-color: #b45309 !important; }
.gantt-block--yellow { background: linear-gradient(135deg, #eab308, #ca8a04) !important; border-color: #a16207 !important; color: #1a1a1a !important; }
.gantt-block--lime { background: linear-gradient(135deg, #84cc16, #65a30d) !important; border-color: #4d7c0f !important; color: #1a1a1a !important; }
.gantt-block--brown { background: linear-gradient(135deg, #a16207, #854d0e) !important; border-color: #713f12 !important; }
.gantt-block--stone { background: linear-gradient(135deg, #78716c, #57534e) !important; border-color: #44403c !important; }
.gantt-block--slate { background: linear-gradient(135deg, #64748b, #475569) !important; border-color: #334155 !important; }
.gantt-block--zinc { background: linear-gradient(135deg, #71717a, #52525b) !important; border-color: #3f3f46 !important; }
.gantt-block--neutral { background: linear-gradient(135deg, #737373, #525252) !important; border-color: #404040 !important; }

/* Text color adjustments for lighter backgrounds */
.gantt-block--yellow .gantt-block__title,
.gantt-block--yellow .gantt-block__time,
.gantt-block--lime .gantt-block__title,
.gantt-block--lime .gantt-block__time {
  color: #1a1a1a !important;
  text-shadow: none !important;
}

/* Block List Grid */
.block-list-section {
  margin-top: 20px;
}

.block-list-section__header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}

.block-list-section__icon {
  font-size: 0.9rem;
}

.block-list-section__title {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.block-list-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
  list-style: none;
}

.block-list-grid .block-item {
  border-radius: 12px;
  padding: 16px 18px;
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  min-height: 90px;
}

/* Block Item Colors - 20 Colors with enhanced left border and subtle background tint */
.block-item--green { border-left: 5px solid #22c55e; background: linear-gradient(90deg, rgba(34, 197, 94, 0.08), transparent 50%); }
.block-item--emerald { border-left: 5px solid #10b981; background: linear-gradient(90deg, rgba(16, 185, 129, 0.08), transparent 50%); }
.block-item--teal { border-left: 5px solid #14b8a6; background: linear-gradient(90deg, rgba(20, 184, 166, 0.08), transparent 50%); }
.block-item--cyan { border-left: 5px solid #06b6d4; background: linear-gradient(90deg, rgba(6, 182, 212, 0.08), transparent 50%); }
.block-item--blue { border-left: 5px solid #3b82f6; background: linear-gradient(90deg, rgba(59, 130, 246, 0.08), transparent 50%); }
.block-item--indigo { border-left: 5px solid #6366f1; background: linear-gradient(90deg, rgba(99, 102, 241, 0.08), transparent 50%); }
.block-item--purple { border-left: 5px solid #a855f7; background: linear-gradient(90deg, rgba(168, 85, 247, 0.08), transparent 50%); }
.block-item--violet { border-left: 5px solid #8b5cf6; background: linear-gradient(90deg, rgba(139, 92, 246, 0.08), transparent 50%); }
.block-item--pink { border-left: 5px solid #ec4899; background: linear-gradient(90deg, rgba(236, 72, 153, 0.08), transparent 50%); }
.block-item--rose { border-left: 5px solid #f43f5e; background: linear-gradient(90deg, rgba(244, 63, 94, 0.08), transparent 50%); }
.block-item--red { border-left: 5px solid #ef4444; background: linear-gradient(90deg, rgba(239, 68, 68, 0.08), transparent 50%); }
.block-item--orange { border-left: 5px solid #f97316; background: linear-gradient(90deg, rgba(249, 115, 22, 0.08), transparent 50%); }
.block-item--amber { border-left: 5px solid #f59e0b; background: linear-gradient(90deg, rgba(245, 158, 11, 0.08), transparent 50%); }
.block-item--yellow { border-left: 5px solid #eab308; background: linear-gradient(90deg, rgba(234, 179, 8, 0.08), transparent 50%); }
.block-item--lime { border-left: 5px solid #84cc16; background: linear-gradient(90deg, rgba(132, 204, 22, 0.08), transparent 50%); }
.block-item--brown { border-left: 5px solid #a16207; background: linear-gradient(90deg, rgba(161, 98, 7, 0.08), transparent 50%); }
.block-item--stone { border-left: 5px solid #78716c; background: linear-gradient(90deg, rgba(120, 113, 108, 0.08), transparent 50%); }
.block-item--slate { border-left: 5px solid #64748b; background: linear-gradient(90deg, rgba(100, 116, 139, 0.08), transparent 50%); }
.block-item--zinc { border-left: 5px solid #71717a; background: linear-gradient(90deg, rgba(113, 113, 122, 0.08), transparent 50%); }
.block-item--neutral { border-left: 5px solid #737373; background: linear-gradient(90deg, rgba(115, 115, 115, 0.08), transparent 50%); }

/* Block item hover state with color accent */
.block-list-grid .block-item:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Color dot indicator for block items */
.block-item__color-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  flex-shrink: 0;
}

/* Empty Schedule Full */
.block-empty-schedule-full {
  text-align: center;
  padding: 60px 20px;
  color: var(--text-muted);
}

.block-empty-schedule-full[hidden] {
  display: none;
}

.block-empty-schedule-full__content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.block-empty-schedule-full__icon {
  font-size: 3rem;
  opacity: 0.4;
}

.block-empty-schedule-full__title {
  font-size: 1.1rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.block-empty-schedule-full__text {
  font-size: 0.9rem;
  max-width: 300px;
}

/* Block Panel Headers - Nâng cấp */
.block-panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.block-panel-title {
  display: flex;
  align-items: center;
  gap: 8px;
}

.block-panel-icon {
  font-size: 1rem;
}

.block-panel-header h3 {
  font-size: 0.9rem;
  font-weight: 600;
  margin: 0;
}

.block-panel-hint {
  font-size: 0.7rem;
  color: var(--text-muted);
  background: var(--bg-2);
  padding: 4px 10px;
  border-radius: 999px;
}

.block-panel-summary {
  font-size: 0.8rem;
  color: var(--accent-2);
  font-weight: 500;
}

/* Tasks Panel (left) */
.block-tasks-panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  max-height: 600px;
  overflow-y: auto;
}

.block-task-group {
  margin-bottom: 20px;
}

.block-task-group:last-child {
  margin-bottom: 0;
}

.block-task-group[hidden] {
  display: none;
}

/* Nâng cấp task group header */
.block-task-group__header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px dashed var(--border);
}

.block-task-group__icon {
  font-size: 0.9rem;
}

.block-task-group__label {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.04em;
  flex: 1;
}

.block-task-group__count {
  font-size: 0.7rem;
  padding: 2px 8px;
  background: var(--bg-2);
  border-radius: 999px;
  color: var(--text-muted);
}

.block-task-list {
  list-style: none;
  display: grid;
  gap: 8px;
}

.block-task-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 10px;
  transition: all 150ms ease;
}

.block-task-item:hover {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.05);
}

.block-task-item__content {
  flex: 1;
  min-width: 0;
}

.block-task-item__title {
  display: block;
  font-size: 0.85rem;
  font-weight: 500;
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.block-task-item__meta {
  font-size: 0.7rem;
  color: var(--text-muted);
}

.block-task-item__urgent {
  color: var(--accent-warm);
  font-weight: 500;
}

.block-task-item__add {
  padding: 6px 12px;
  border: 1px solid var(--accent);
  border-radius: 8px;
  background: transparent;
  color: var(--accent);
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 150ms ease;
  white-space: nowrap;
}

.block-task-item__add:hover {
  background: var(--accent);
  color: var(--bg);
}

/* Empty Tasks State - Nâng cấp */
.block-empty-tasks {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-muted);
}

.block-empty-tasks[hidden] {
  display: none;
}

.block-empty-tasks__content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.block-empty-tasks__icon {
  font-size: 2.5rem;
  opacity: 0.4;
}

.block-empty-tasks__title {
  font-size: 0.95rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.block-empty-tasks__text {
  font-size: 0.8rem;
  margin-bottom: 8px;
}

/* Schedule Panel (right) */
.block-schedule-panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  position: relative;
  overflow: hidden;
}

.block-schedule-panel::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--accent-2), var(--accent));
  opacity: 0.8;
}

/* Quick Add Bar - Nâng cấp */
.block-quick-add {
  display: flex;
  align-items: flex-end;
  gap: 12px;
  margin-bottom: 20px;
  padding: 16px;
  background: var(--bg-2);
  border-radius: 12px;
}

.block-quick-add__field {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.block-quick-add__field--grow {
  flex: 1;
}

.block-quick-add__label {
  font-size: 0.65rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-muted);
  font-weight: 500;
}

.block-quick-time {
  width: 90px;
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--surface);
  color: var(--text);
  font-size: 0.85rem;
  font-family: inherit;
}

.block-quick-time:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(212, 184, 114, 0.1);
}

.block-quick-title {
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--surface);
  color: var(--text);
  font-size: 0.85rem;
  font-family: inherit;
}

.block-quick-title:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(212, 184, 114, 0.1);
}

.block-quick-title::placeholder {
  color: var(--text-muted);
}

.block-quick-duration {
  width: 70px;
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--surface);
  color: var(--text);
  font-size: 0.85rem;
  font-family: inherit;
  text-align: center;
}

.block-quick-duration:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(212, 184, 114, 0.1);
}

/* Timeline Wrapper */
.block-timeline-wrapper {
  max-height: 300px;
  overflow-y: auto;
  margin-top: 16px;
}

.block-list-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px dashed var(--border);
}

.block-list-header__icon {
  font-size: 0.9rem;
}

.block-list-header__title {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

/* ==================== GANTT CHART ==================== */
.gantt-container {
  background: var(--bg-2);
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 16px;
}

.gantt-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--border);
}

.gantt-header__icon {
  font-size: 1rem;
}

.gantt-header__title {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.gantt-timeline {
  position: relative;
  min-height: 120px;
  background: var(--surface);
  border-radius: 10px;
  overflow: hidden;
}

.gantt-time-axis {
  display: flex;
  justify-content: space-between;
  padding: 8px 12px;
  background: var(--gantt-axis-bg);
  border-bottom: 1px solid var(--border);
}

.gantt-time-marker {
  font-size: 0.65rem;
  color: var(--text-muted);
  text-align: center;
  flex: 1;
  position: relative;
}

.gantt-time-marker::after {
  content: "";
  position: absolute;
  bottom: -8px;
  left: 50%;
  transform: translateX(-50%);
  width: 1px;
  height: 4px;
  background: var(--border);
}

.gantt-now-line {
  position: absolute;
  top: 32px;
  bottom: 0;
  width: 2px;
  background: linear-gradient(180deg, var(--accent), rgba(212, 184, 114, 0.3));
  z-index: 10;
  box-shadow: 0 0 8px rgba(212, 184, 114, 0.5);
}

.gantt-now-line::before {
  content: "NOW";
  position: absolute;
  top: -20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 0.55rem;
  font-weight: 700;
  color: var(--accent);
  background: var(--bg-2);
  padding: 2px 6px;
  border-radius: 4px;
  letter-spacing: 0.05em;
}

.gantt-blocks {
  position: relative;
  padding: 12px;
  min-height: 80px;
}

.gantt-block {
  position: absolute;
  height: 44px;
  border-radius: 10px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: 6px 12px;
  cursor: pointer;
  transition: all 150ms ease;
  overflow: hidden;
  font-size: 0.75rem;
  font-weight: 500;
  border-width: 2px;
  border-style: solid;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.gantt-block:hover {
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.35);
  z-index: 20;
}

/* Gantt block compact mode (khi width < 12%) */
.gantt-block--compact {
  padding: 4px 8px;
}

.gantt-block--compact .gantt-block__title {
  font-size: 0.7rem;
}

.gantt-block--compact .gantt-block__time {
  font-size: 0.6rem;
}

.gantt-block--pending {
  background: linear-gradient(135deg, rgba(90, 158, 118, 0.8), rgba(90, 158, 118, 0.6));
  color: var(--bg);
  border: 1px solid var(--accent-2);
}

.gantt-block--in_progress {
  background: linear-gradient(135deg, var(--accent), rgba(212, 184, 114, 0.8));
  color: var(--bg);
  border: 1px solid var(--accent);
  animation: ganttPulse 2s ease-in-out infinite;
}

@keyframes ganttPulse {
  0%, 100% { box-shadow: 0 0 0 0 rgba(212, 184, 114, 0.4); }
  50% { box-shadow: 0 0 0 6px rgba(212, 184, 114, 0); }
}

.gantt-block--completed {
  background: rgba(90, 158, 118, 0.3);
  color: var(--accent-2);
  border: 1px solid rgba(90, 158, 118, 0.4);
  opacity: 0.6;
}

.gantt-block--missed {
  background: rgba(184, 136, 90, 0.3);
  color: var(--accent-warm);
  border: 1px solid rgba(184, 136, 90, 0.4);
  opacity: 0.6;
}

.gantt-block__title {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  line-height: 1.3;
  color: var(--bg);
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.gantt-block__time {
  font-size: 0.65rem;
  opacity: 0.9;
  white-space: nowrap;
  color: var(--bg);
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.gantt-empty {
  text-align: center;
  padding: 24px 16px;
  color: var(--text-muted);
  font-size: 0.85rem;
}

.gantt-empty__icon {
  font-size: 1.5rem;
  display: block;
  margin-bottom: 8px;
  opacity: 0.4;
}

/* Empty Schedule State - Nâng cấp */
.block-empty-schedule {
  text-align: center;
  padding: 50px 20px;
  color: var(--text-muted);
}

.block-empty-schedule[hidden] {
  display: none;
}

.block-empty-schedule__content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.block-empty-schedule__icon {
  font-size: 2.5rem;
  opacity: 0.4;
}

.block-empty-schedule__title {
  font-size: 0.95rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.block-empty-schedule__icon {
  display: block;
  font-size: 2.5rem;
  margin-bottom: 12px;
  opacity: 0.5;
}

.block-empty-schedule__text {
  display: block;
  font-size: 0.95rem;
  color: var(--text-secondary);
  margin-bottom: 6px;
}

.block-empty-schedule__hint {
  display: block;
  font-size: 0.8rem;
}

/* Legacy Block Add Card */
.block-add-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 24px;
}

.block-add-row {
  display: flex;
  align-items: flex-end;
  gap: 16px;
  flex-wrap: wrap;
}

.block-add-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.block-add-field--grow {
  flex: 1;
  min-width: 200px;
}

.block-add-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.block-add-time {
  width: 110px;
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 0.9rem;
  font-family: inherit;
}

.block-add-time:focus {
  outline: none;
  border-color: var(--accent);
}

.block-add-duration {
  display: flex;
  align-items: center;
  gap: 8px;
}

.block-add-duration input {
  width: 70px;
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 0.9rem;
  font-family: inherit;
  text-align: center;
}

.block-add-duration input:focus {
  outline: none;
  border-color: var(--accent);
}

.block-add-duration span {
  font-size: 0.85rem;
  color: var(--text-muted);
}

.block-add-select {
  width: 100%;
  padding: 10px 14px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 0.85rem;
  font-family: inherit;
  cursor: pointer;
}

.block-add-select:focus {
  outline: none;
  border-color: var(--accent);
}

.block-add-custom {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px dashed var(--border);
}

.block-add-custom-input {
  width: 100%;
  padding: 10px 14px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 0.85rem;
  font-family: inherit;
}

.block-add-custom-input:focus {
  outline: none;
  border-color: var(--accent);
}

.block-add-custom-input::placeholder {
  color: var(--text-muted);
  font-style: italic;
}

/* Timeline */
.block-timeline {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
}

.block-timeline__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.block-timeline__title {
  font-weight: 600;
  font-size: 0.95rem;
}

.block-timeline__summary {
  font-size: 0.8rem;
  color: var(--text-muted);
}

/* Legacy styles for compatibility */
.block-input-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-bottom: 24px;
  padding: 16px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
}

.block-input-bar input[type="time"] {
  width: 120px;
}

.block-input-bar input[type="number"] {
  width: 80px;
}

.block-input-bar input[type="text"] {
  flex: 1;
  min-width: 180px;
}

.block-task-select {
  padding: 10px 14px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 0.85rem;
  font-family: inherit;
  min-width: 200px;
  cursor: pointer;
}

.block-task-select:focus {
  outline: none;
  border-color: var(--accent);
}

.block-list {
  list-style: none;
  display: grid;
  gap: 10px;
}

.block-empty {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-muted);
}

.block-empty__icon {
  font-size: 2.5rem;
  margin-bottom: 12px;
  opacity: 0.5;
}

.block-empty__text {
  font-size: 1rem;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.block-empty__hint {
  font-size: 0.8rem;
  color: var(--text-muted);
}

.block-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px 18px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  min-height: 90px;
}

.block-item.block-completed {
  opacity: 0.5;
}

.block-item.block-missed {
  border-color: rgba(184, 136, 90, 0.4);
}

.block-item.block-active {
  border-color: var(--accent-2);
  background: rgba(90, 158, 118, 0.08);
}

.block-time {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--accent);
}

.block-title-wrapper {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.block-title {
  display: block;
  font-size: 0.95rem;
  font-weight: 500;
  line-height: 1.4;
}

.block-item__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.block-duration {
  font-size: 0.75rem;
  color: var(--text-muted);
  background: var(--bg-2);
  padding: 2px 8px;
  border-radius: 999px;
}

.block-status {
  font-size: 0.7rem;
  padding: 2px 8px;
  border-radius: 999px;
  width: fit-content;
  margin-top: 4px;
}

.block-status--in_progress {
  background: rgba(90, 158, 118, 0.2);
  color: var(--accent-2);
}

.block-status--completed {
  background: rgba(90, 158, 118, 0.15);
  color: var(--accent-soft);
}

.block-status--missed {
  background: rgba(184, 136, 90, 0.2);
  color: var(--accent-warm);
}

.block-status--upcoming {
  background: rgba(212, 184, 114, 0.2);
  color: var(--accent);
}

.block-status--now {
  background: rgba(229, 115, 115, 0.2);
  color: #e57373;
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

.block-actions {
  display: flex;
  gap: 8px;
  margin-top: auto;
  padding-top: 8px;
  border-top: 1px solid var(--border);
}

.block-btn {
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 999px;
  background: transparent;
  color: var(--text-secondary);
  font-size: 0.8rem;
  cursor: pointer;
}

.block-btn.primary {
  border-color: rgba(212, 184, 114, 0.5);
  color: var(--accent);
}

.block-btn--focus {
  width: 36px;
  height: 36px;
  padding: 0;
  border: 1px solid rgba(229, 115, 115, 0.4);
  border-radius: 50%;
  background: rgba(229, 115, 115, 0.1);
  font-size: 1rem;
  display: grid;
  place-items: center;
  transition: all 150ms ease;
}

.block-btn--focus:hover {
  border-color: #e57373;
  background: rgba(229, 115, 115, 0.2);
  transform: scale(1.1);
}

.block-btn--retry {
  width: 36px;
  height: 36px;
  padding: 0;
  border: 1px solid rgba(212, 184, 114, 0.4);
  border-radius: 50%;
  background: rgba(212, 184, 114, 0.1);
  font-size: 1rem;
  display: grid;
  place-items: center;
  transition: all 150ms ease;
}

.block-btn--retry:hover {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.2);
  transform: scale(1.1);
}

.block-footer {
  display: flex;
  justify-content: space-between;
  margin-top: 16px;
}

/* ==================== STATS ==================== */
.stats-overview {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 24px;
  margin-bottom: 32px;
  padding: 24px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
}

.stat-card {
  text-align: center;
}

.stat-card__ring {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  background: conic-gradient(var(--accent-2) var(--progress), var(--border) 0);
  display: grid;
  place-items: center;
  margin: 0 auto 12px;
  transition: background 600ms cubic-bezier(0.4, 0, 0.2, 1);
}

.stat-card__ring-inner {
  width: 90px;
  height: 90px;
  border-radius: 50%;
  background: var(--surface);
  display: grid;
  place-items: center;
}

.stat-card__ring-inner span {
  font-size: 1.3rem;
  font-weight: 600;
}

.stat-card__message {
  font-size: 0.85rem;
  color: var(--text-muted);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  align-content: center;
}

.stat-box {
  text-align: center;
  padding: 16px;
  background: var(--bg-2);
  border-radius: 12px;
}

.stat-box__value {
  font-size: 2rem;
  font-weight: 600;
  color: var(--accent);
  display: block;
}

.stat-box__label {
  font-size: 0.8rem;
  color: var(--text-muted);
}

.stats-section {
  margin-top: 24px;
}

.stats-section h3 {
  font-size: 0.9rem;
  font-weight: 500;
  margin-bottom: 16px;
  color: var(--text-secondary);
}

.week-chart {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 10px;
  height: 140px;
  align-items: end;
  padding: 20px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
}

.week-bar {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.week-bar__fill {
  width: 100%;
  border-radius: 6px;
  background: linear-gradient(180deg, var(--accent-2), var(--accent));
  height: var(--bar-height, 10px);
  min-height: 8px;
}

.week-bar__fill.is-zero {
  background: var(--border);
}

.week-bar__label {
  font-size: 0.7rem;
  color: var(--text-muted);
}

.session-list {
  list-style: none;
  display: grid;
  gap: 8px;
}

.session-item {
  padding: 12px 16px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  font-size: 0.85rem;
  color: var(--text-secondary);
}

/* ==================== SETTINGS ==================== */
.settings-sections {
  max-width: 500px;
}

.settings-group {
  margin-bottom: 28px;
  padding: 20px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
}

.settings-group h3 {
  font-size: 0.9rem;
  font-weight: 500;
  margin-bottom: 16px;
  color: var(--text);
}

.settings-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0;
  border-bottom: 1px solid var(--border);
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.settings-row:last-child {
  border-bottom: none;
}

.settings-row input {
  width: 80px;
  text-align: center;
}

.settings-toggle {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 0;
  border-bottom: 1px solid var(--border);
  font-size: 0.9rem;
  color: var(--text-secondary);
  cursor: pointer;
}

.settings-toggle:last-of-type {
  border-bottom: none;
}

.settings-toggle input {
  width: 18px;
  height: 18px;
  accent-color: var(--accent-2);
}

.settings-hint {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-top: 8px;
}

/* ==================== BUTTONS ==================== */
.btn {
  padding: 10px 20px;
  border: 1px solid var(--border);
  border-radius: 999px;
  background: var(--surface);
  color: var(--text);
  font-size: 0.9rem;
  font-weight: 500;
  font-family: inherit;
  cursor: pointer;
  transition: all 150ms ease;
}

.btn:hover {
  background: var(--surface-2);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn--primary {
  background: var(--accent);
  color: var(--bg);
  border-color: transparent;
}

.btn--primary:hover {
  filter: brightness(1.1);
}

.btn--success {
  background: var(--accent-2);
  color: var(--bg);
  border-color: transparent;
}

.btn--success:hover {
  filter: brightness(1.1);
}

.btn--accent {
  background: var(--accent);
  color: var(--bg);
  border-color: transparent;
}

.btn--accent:hover {
  filter: brightness(1.1);
}

.btn--ghost {
  background: transparent;
  border-color: var(--border-light);
}

.btn--ghost:hover {
  background: var(--surface);
}

.btn--large {
  padding: 14px 32px;
  font-size: 1rem;
}

.btn--small {
  padding: 6px 12px;
  font-size: 0.8rem;
}

.btn--full {
  width: 100%;
}

/* ==================== INPUTS ==================== */
input[type="text"],
input[type="number"],
input[type="time"] {
  padding: 10px 14px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  color: var(--text);
  font-size: 0.9rem;
  font-family: inherit;
}

input::placeholder {
  color: var(--text-muted);
}

input:focus {
  outline: none;
  border-color: var(--accent);
}

/* ==================== MODAL ==================== */
.modal {
  position: fixed;
  inset: 0;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.modal[hidden] {
  display: none;
}

.modal__backdrop {
  position: absolute;
  inset: 0;
  background: var(--modal-backdrop);
  backdrop-filter: blur(4px);
}

.modal__content {
  position: relative;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 28px;
  max-width: 400px;
  width: 100%;
  animation: modalIn 200ms ease;
}

@keyframes modalIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.modal__header {
  text-align: center;
  margin-bottom: 16px;
}

.modal__icon {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: rgba(90, 158, 118, 0.2);
  color: var(--accent-2);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 1.8rem;
  margin-bottom: 12px;
}

.modal__header h3 {
  font-size: 1.1rem;
}

.modal__message {
  text-align: center;
  color: var(--text-secondary);
  margin-bottom: 20px;
}

.modal__section {
  padding: 14px;
  background: var(--bg-2);
  border-radius: 12px;
  margin-bottom: 16px;
}

.modal__label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.modal__task-name {
  font-weight: 500;
  margin-bottom: 12px;
}

.modal__next-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.modal__actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

/* ==================== UTILITIES ==================== */
.muted {
  color: var(--text-muted);
  font-size: 0.85rem;
}

/* ==================== MOBILE MENU TOGGLE ==================== */
.mobile-menu-toggle {
  display: none;
  position: fixed;
  top: 16px;
  left: 16px;
  z-index: 200;
  width: 44px;
  height: 44px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--surface);
  cursor: pointer;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 5px;
}

.mobile-menu-toggle span {
  display: block;
  width: 20px;
  height: 2px;
  background: var(--text);
  border-radius: 2px;
  transition: all 150ms ease;
}

.mobile-menu-toggle.is-active span:nth-child(1) {
  transform: rotate(45deg) translate(5px, 5px);
}

.mobile-menu-toggle.is-active span:nth-child(2) {
  opacity: 0;
}

.mobile-menu-toggle.is-active span:nth-child(3) {
  transform: rotate(-45deg) translate(5px, -5px);
}

/* ==================== RESPONSIVE ==================== */
@media (max-width: 1000px) {
  .dashboard-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 900px) {
  :root {
    --nav-width: 200px;
  }
}

@media (max-width: 768px) {
  :root {
    --nav-width: 0;
  }

  .mobile-menu-toggle {
    display: flex;
  }

  .app-shell {
    grid-template-columns: 1fr;
  }

  .flow-guide {
    flex-wrap: wrap;
    gap: 12px;
  }

  .flow-step {
    font-size: 0.8rem;
    padding: 6px 12px;
  }

  .flow-step__label {
    display: none;
  }

  .next-action-card {
    flex-direction: column;
    text-align: center;
    gap: 16px;
  }

  .nav-sidebar {
    position: fixed;
    left: -260px;
    width: 260px;
    transition: left 200ms ease;
    z-index: 100;
  }

  .nav-sidebar.is-open {
    left: 0;
  }

  .main-content {
    grid-column: 1;
    padding: 70px 20px 24px;
  }

  .dashboard-grid {
    grid-template-columns: 1fr;
  }

  .home-grid {
    grid-template-columns: 1fr;
  }

  .home-card--wide {
    grid-column: 1;
  }

  .analytics-grid {
    grid-template-columns: 1fr 1fr;
  }

  .analytics-card--goal {
    grid-column: span 2;
    grid-row: span 1;
  }

  .matrix-eisenhower {
    grid-template-columns: 1fr;
  }

  .matrix-quadrant {
    min-height: 150px;
  }

  .stats-overview {
    grid-template-columns: 1fr;
  }

  .timer-layout {
    grid-template-columns: 1fr;
  }

  .timer-sidebar {
    order: -1;
    max-height: 200px;
  }

  .timer-flow-layout {
    grid-template-columns: 1fr;
  }

  .timer-blocks-panel {
    order: -1;
    max-height: 250px;
  }

  .timer-focus-panel {
    padding: 30px 20px;
  }

  .block-layout {
    grid-template-columns: 1fr;
  }

  .block-tasks-panel {
    max-height: 300px;
  }

  .block-quick-add {
    flex-wrap: wrap;
  }

  .block-quick-title {
    order: 1;
    width: 100%;
  }

  .timer-display {
    font-size: 3.5rem;
  }

  .gantt-timeline {
    min-height: 100px;
  }

  .gantt-block {
    font-size: 0.65rem;
    padding: 0 8px;
  }
}

@media (max-width: 480px) {
  .dashboard-grid {
    grid-template-columns: 1fr;
  }

  .task-input-bar,
  .block-input-bar {
    flex-direction: column;
  }

  .task-input-bar input,
  .block-input-bar input {
    width: 100%;
  }

  .modal__actions {
    flex-direction: column;
  }
}

/* ==================== GUIDE PAGE ==================== */

.view-step-badge--guide {
  background: rgba(139, 163, 122, 0.12);
  border-color: rgba(139, 163, 122, 0.25);
  color: var(--accent-soft);
}

.guide-content {
  max-width: 900px;
}

.guide-section {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 20px;
}

.guide-section--highlight {
  background: linear-gradient(135deg, var(--surface), rgba(212, 184, 114, 0.08));
  border-color: rgba(212, 184, 114, 0.3);
}

.guide-section__header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.guide-section__icon {
  font-size: 1.3rem;
}

.guide-section__header h3 {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 0;
}

.guide-section__text {
  color: var(--text-secondary);
  line-height: 1.7;
  font-size: 0.95rem;
}

.guide-section__text strong {
  color: var(--accent);
}

/* Guide Steps */
.guide-steps {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.guide-step {
  display: flex;
  gap: 20px;
  padding: 20px;
  background: var(--bg-2);
  border-radius: 12px;
  border: 1px solid var(--border);
}

.guide-step__number {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  color: var(--bg);
  font-size: 1.2rem;
  font-weight: 700;
  display: grid;
  place-items: center;
  flex-shrink: 0;
}

.guide-step__content {
  flex: 1;
}

.guide-step__content h4 {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 10px;
  color: var(--text);
}

.guide-step__content p {
  color: var(--text-secondary);
  font-size: 0.9rem;
  line-height: 1.6;
  margin-bottom: 10px;
}

.guide-step__content ul {
  list-style: none;
  padding: 0;
  margin: 12px 0;
}

.guide-step__content ul li {
  padding: 6px 0 6px 20px;
  position: relative;
  color: var(--text-secondary);
  font-size: 0.85rem;
}

.guide-step__content ul li::before {
  content: "•";
  position: absolute;
  left: 0;
  color: var(--accent-2);
  font-weight: bold;
}

.guide-tip {
  padding: 10px 14px;
  background: rgba(212, 184, 114, 0.1);
  border-radius: 8px;
  font-size: 0.85rem;
  color: var(--accent);
  margin-top: 12px;
}

.guide-tip em {
  font-style: normal;
}

/* Tips Grid */
.guide-tips-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 16px;
}

.guide-tip-card {
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  transition: all 150ms ease;
}

.guide-tip-card:hover {
  border-color: var(--accent-2);
  transform: translateY(-2px);
}

.guide-tip-card__icon {
  font-size: 1.5rem;
  display: block;
  margin-bottom: 10px;
}

.guide-tip-card h5 {
  font-size: 0.95rem;
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--text);
}

.guide-tip-card p {
  font-size: 0.85rem;
  color: var(--text-muted);
  line-height: 1.5;
}

/* Shortcuts */
.guide-shortcuts {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.guide-shortcut {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px 16px;
  background: var(--bg-2);
  border-radius: 10px;
}

.guide-shortcut kbd {
  background: var(--surface-2);
  border: 1px solid var(--border-light);
  border-radius: 6px;
  padding: 6px 12px;
  font-family: monospace;
  font-size: 0.85rem;
  color: var(--accent);
  box-shadow: 0 2px 0 var(--border);
  min-width: 100px;
  text-align: center;
}

.guide-shortcut span {
  color: var(--text-secondary);
  font-size: 0.9rem;
}

/* Credits */
.guide-section--credits {
  text-align: center;
  background: transparent;
  border: none;
  padding: 30px;
}

.guide-section--credits p {
  color: var(--text-muted);
  font-size: 0.9rem;
  margin-bottom: 8px;
}

.guide-section--credits strong {
  color: var(--accent);
}

.guide-version {
  font-size: 0.75rem !important;
  color: var(--text-muted) !important;
  opacity: 0.6;
}

/* Mobile responsive for guide */
@media (max-width: 768px) {
  .guide-step {
    flex-direction: column;
    text-align: center;
  }

  .guide-step__content ul li {
    text-align: left;
  }

  .guide-tips-grid {
    grid-template-columns: 1fr;
  }

  .guide-shortcut {
    flex-direction: column;
    text-align: center;
    gap: 8px;
  }
}

/* ==================== FOCUS-VISIBLE STYLES ==================== */
*:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

input:focus-visible,
select:focus-visible,
textarea:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 0;
  border-color: var(--accent);
}

.btn:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(212, 184, 114, 0.2);
}

.nav-item:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: -2px;
  background: var(--surface);
}

.task-item:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: -2px;
}

.preset-btn:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

.block-color-btn:focus-visible {
  outline: 2px solid var(--text);
  outline-offset: 2px;
}

.toggle-chip:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* ==================== TOAST NOTIFICATION SYSTEM ==================== */
.toast-container {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-width: 380px;
  pointer-events: none;
}

.toast {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px 18px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 8px 24px var(--toast-shadow);
  font-size: 0.9rem;
  color: var(--text);
  animation: toastIn 300ms ease forwards;
  pointer-events: auto;
}

.toast--success {
  border-color: rgba(90, 158, 118, 0.5);
  background: linear-gradient(135deg, var(--surface), rgba(90, 158, 118, 0.1));
}

.toast--error {
  border-color: rgba(229, 115, 115, 0.5);
  background: linear-gradient(135deg, var(--surface), rgba(229, 115, 115, 0.1));
}

.toast--warning {
  border-color: rgba(212, 184, 114, 0.5);
  background: linear-gradient(135deg, var(--surface), rgba(212, 184, 114, 0.1));
}

.toast--info {
  border-color: rgba(59, 130, 246, 0.5);
  background: linear-gradient(135deg, var(--surface), rgba(59, 130, 246, 0.1));
}

.toast__icon {
  font-size: 1.2rem;
  flex-shrink: 0;
}

.toast__message {
  flex: 1;
  line-height: 1.4;
}

.toast__close {
  width: 28px;
  height: 28px;
  border: none;
  border-radius: 6px;
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  font-size: 0.9rem;
  display: grid;
  place-items: center;
  flex-shrink: 0;
  transition: all 150ms ease;
}

.toast__close:hover {
  background: var(--bg-2);
  color: var(--text);
}

.toast.is-leaving {
  animation: toastOut 300ms ease forwards;
}

@keyframes toastIn {
  from { opacity: 0; transform: translateX(40px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes toastOut {
  from { opacity: 1; transform: translateX(0); }
  to { opacity: 0; transform: translateX(40px); }
}

/* ==================== TOUCH TARGET IMPROVEMENTS ==================== */
.block-color-btn {
  min-width: 36px;
  min-height: 36px;
}

.task-item__btn {
  min-width: 36px;
  min-height: 36px;
}

.block-btn {
  min-height: 36px;
}

.btn--small {
  min-height: 36px;
  padding: 8px 14px;
}

/* ==================== Z-INDEX CONSOLIDATION ==================== */
/* z-index scale:
   10  - gantt now line
   20  - gantt block hover
   100 - color popup, dropdowns
   200 - mobile menu toggle
   500 - mobile sidebar
   1500 - modal
   2000 - toast
*/
.modal {
  z-index: 1500;
}

.task-item.drag-ghost {
  z-index: 500;
}

.nav-sidebar.is-open {
  z-index: 500;
}

/* ==================== DATA EXPORT/IMPORT SETTINGS ==================== */
.settings-data-actions {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
}

.settings-data-actions .btn {
  flex: 1;
}

/* ==================== TABLET RESPONSIVE (768-1024px) ==================== */
@media (max-width: 1024px) and (min-width: 769px) {
  .analytics-grid {
    grid-template-columns: 1fr 1fr;
  }

  .block-quick-add-bar {
    flex-wrap: wrap;
  }

  .block-quick-add-bar__field--grow {
    min-width: 180px;
  }

  .matrix-labels--top {
    display: none;
  }

  .matrix-with-labels {
    grid-template-columns: 1fr;
  }

  .matrix-labels--left {
    display: none;
  }
}

/* ==================== TOAST RESPONSIVE ==================== */
@media (max-width: 480px) {
  .toast-container {
    top: auto;
    bottom: 20px;
    left: 16px;
    right: 16px;
    max-width: none;
  }

  .settings-data-actions {
    flex-direction: column;
  }
}

/* ==================== FEATURE: CUSTOM MODAL SYSTEM ==================== */
.custom-modal {
  position: fixed;
  inset: 0;
  z-index: 2000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
  animation: customModalFadeIn 150ms ease;
}

.custom-modal[hidden] {
  display: none;
}

@keyframes customModalFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes customModalContentIn {
  from { opacity: 0; transform: scale(0.92) translateY(8px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

@keyframes customModalContentOut {
  from { opacity: 1; transform: scale(1) translateY(0); }
  to { opacity: 0; transform: scale(0.92) translateY(8px); }
}

.custom-modal__backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(4px);
}

.custom-modal__content {
  position: relative;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 24px;
  max-width: 400px;
  width: 100%;
  animation: customModalContentIn 200ms ease;
  box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4);
}

.custom-modal.is-closing .custom-modal__content {
  animation: customModalContentOut 150ms ease forwards;
}

.custom-modal.is-closing .custom-modal__backdrop {
  animation: customModalFadeIn 150ms ease reverse forwards;
}

.custom-modal__title {
  font-size: 1.05rem;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--text);
}

.custom-modal__message {
  color: var(--text-secondary);
  font-size: 0.9rem;
  margin-bottom: 20px;
  line-height: 1.5;
}

.custom-modal__input {
  width: 100%;
  padding: 12px 14px;
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 10px;
  color: var(--text);
  font-size: 0.95rem;
  font-family: inherit;
  margin-bottom: 20px;
  outline: none;
  transition: border-color 150ms ease;
}

.custom-modal__input:focus {
  border-color: var(--accent);
}

.custom-modal__actions {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

.custom-modal__actions .btn {
  min-width: 80px;
}

/* ==================== FEATURE: INLINE TASK EDITING ==================== */
.task-item__title--editing {
  display: none;
}

.task-item__inline-edit {
  width: 100%;
  padding: 4px 8px;
  background: var(--bg);
  border: 1px solid var(--accent);
  border-radius: 6px;
  color: var(--text);
  font-size: 0.9rem;
  font-family: inherit;
  outline: none;
  margin-bottom: 4px;
  animation: inlineEditIn 150ms ease;
}

@keyframes inlineEditIn {
  from { opacity: 0; transform: scaleY(0.9); }
  to { opacity: 1; transform: scaleY(1); }
}

.task-item__inline-edit:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(212, 184, 114, 0.2);
}

/* ==================== FEATURE: TASK NOTES/DESCRIPTION ==================== */
.task-item__notes-toggle {
  width: 24px;
  height: 24px;
  border: none;
  border-radius: 6px;
  background: transparent;
  color: var(--text-muted);
  font-size: 0.75rem;
  cursor: pointer;
  display: grid;
  place-items: center;
  transition: all 150ms ease;
  flex-shrink: 0;
  margin-top: 2px;
}

.task-item__notes-toggle:hover {
  background: var(--surface);
  color: var(--text);
}

.task-item__notes-toggle.has-notes {
  color: var(--accent);
}

.task-item__notes-section {
  width: 100%;
  padding-top: 8px;
  margin-top: 8px;
  border-top: 1px solid var(--border);
  animation: notesSlideIn 200ms ease;
}

@keyframes notesSlideIn {
  from { opacity: 0; max-height: 0; }
  to { opacity: 1; max-height: 200px; }
}

.task-item__notes-textarea {
  width: 100%;
  min-height: 60px;
  max-height: 150px;
  padding: 8px 10px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text);
  font-size: 0.8rem;
  font-family: inherit;
  resize: vertical;
  outline: none;
  transition: border-color 150ms ease;
  line-height: 1.4;
}

.task-item__notes-textarea:focus {
  border-color: var(--accent);
}

.task-item__notes-textarea::placeholder {
  color: var(--text-muted);
}

/* ==================== FEATURE: SUBTASKS/CHECKLIST ==================== */
.task-item__subtasks-section {
  width: 100%;
  padding-top: 8px;
  margin-top: 4px;
}

.task-item__subtasks-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 6px;
}

.task-item__subtasks-progress {
  font-size: 0.7rem;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 6px;
}

.task-item__subtasks-progress-bar {
  width: 48px;
  height: 4px;
  background: var(--border);
  border-radius: 2px;
  overflow: hidden;
}

.task-item__subtasks-progress-fill {
  height: 100%;
  background: var(--accent-2);
  border-radius: 2px;
  transition: width 200ms ease;
}

.task-item__subtasks-toggle-btn {
  border: none;
  background: transparent;
  color: var(--text-muted);
  font-size: 0.7rem;
  cursor: pointer;
  padding: 2px 6px;
  border-radius: 4px;
  font-family: inherit;
  transition: all 150ms ease;
}

.task-item__subtasks-toggle-btn:hover {
  background: var(--surface);
  color: var(--text);
}

.task-item__subtasks-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 6px;
}

.subtask-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  border-radius: 6px;
  transition: background 100ms ease;
}

.subtask-item:hover {
  background: rgba(255, 255, 255, 0.03);
}

.subtask-item__checkbox {
  width: 16px;
  height: 16px;
  accent-color: var(--accent-2);
  cursor: pointer;
  flex-shrink: 0;
}

.subtask-item__text {
  flex: 1;
  font-size: 0.8rem;
  color: var(--text-secondary);
  min-width: 0;
  word-break: break-word;
}

.subtask-item.is-done .subtask-item__text {
  text-decoration: line-through;
  opacity: 0.5;
}

.subtask-item__delete {
  width: 20px;
  height: 20px;
  border: none;
  border-radius: 4px;
  background: transparent;
  color: var(--text-muted);
  font-size: 0.65rem;
  cursor: pointer;
  display: grid;
  place-items: center;
  opacity: 0;
  transition: all 100ms ease;
}

.subtask-item:hover .subtask-item__delete {
  opacity: 1;
}

.subtask-item__delete:hover {
  background: rgba(232, 178, 124, 0.15);
  color: var(--accent-warm);
}

.task-item__add-subtask {
  display: flex;
  gap: 6px;
  align-items: center;
}

.task-item__add-subtask-input {
  flex: 1;
  padding: 4px 8px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  color: var(--text);
  font-size: 0.78rem;
  font-family: inherit;
  outline: none;
  transition: border-color 150ms ease;
}

.task-item__add-subtask-input:focus {
  border-color: var(--accent);
}

.task-item__add-subtask-input::placeholder {
  color: var(--text-muted);
}

.task-item__add-subtask-btn {
  width: 26px;
  height: 26px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: transparent;
  color: var(--accent-2);
  font-size: 0.85rem;
  cursor: pointer;
  display: grid;
  place-items: center;
  transition: all 150ms ease;
  flex-shrink: 0;
}

.task-item__add-subtask-btn:hover {
  background: rgba(90, 158, 118, 0.15);
  border-color: var(--accent-2);
}

.task-item__badge--notes {
  background: rgba(182, 155, 218, 0.15);
  color: #b69bda;
}

.task-item__badge--subtasks {
  background: rgba(90, 158, 118, 0.15);
  color: var(--accent-2);
}

.task-item__subtasks-section {
  width: 100%;
  padding: 8px 12px 4px;
}

.task-item__subtasks-header {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 6px;
}

/* ==================== FEATURE: UNDO TOAST ==================== */
.toast__undo-btn {
  padding: 4px 12px;
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: 999px;
  background: rgba(255, 255, 255, 0.1);
  color: var(--accent);
  font-size: 0.78rem;
  font-weight: 600;
  font-family: inherit;
  cursor: pointer;
  transition: all 150ms ease;
  white-space: nowrap;
  margin-left: 8px;
}

.toast__undo-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  border-color: var(--accent);
}

/* Task-item expansion for notes/subtasks */
.task-item--expanded {
  flex-wrap: wrap;
}

.task-item--expanded .task-item__content {
  flex-basis: 0;
}

/* ==================== KEYBOARD SHORTCUTS MODAL ==================== */
.shortcuts-modal {
  position: fixed;
  inset: 0;
  z-index: 1800;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.shortcuts-modal[hidden] {
  display: none;
}

.shortcuts-modal__backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(8px);
  animation: shortcutsBackdropIn 200ms ease forwards;
}

@keyframes shortcutsBackdropIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.shortcuts-modal__content {
  position: relative;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 0;
  max-width: 560px;
  width: 100%;
  animation: shortcutsModalIn 300ms cubic-bezier(0.22, 1, 0.36, 1) forwards;
  overflow: hidden;
  box-shadow: 0 24px 48px rgba(0, 0, 0, 0.5);
}

@keyframes shortcutsModalIn {
  from { opacity: 0; transform: scale(0.92) translateY(20px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

.shortcuts-modal.is-closing .shortcuts-modal__backdrop {
  animation: shortcutsBackdropOut 200ms ease forwards;
}

.shortcuts-modal.is-closing .shortcuts-modal__content {
  animation: shortcutsModalOut 200ms ease forwards;
}

@keyframes shortcutsBackdropOut {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes shortcutsModalOut {
  from { opacity: 1; transform: scale(1) translateY(0); }
  to { opacity: 0; transform: scale(0.95) translateY(10px); }
}

.shortcuts-modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 24px;
  border-bottom: 1px solid var(--border);
  background: var(--bg-2);
}

.shortcuts-modal__title-row {
  display: flex;
  align-items: center;
  gap: 10px;
}

.shortcuts-modal__icon {
  font-size: 1.3rem;
}

.shortcuts-modal__header h3 {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 0;
}

.shortcuts-modal__close {
  width: 36px;
  height: 36px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: transparent;
  color: var(--text-muted);
  font-size: 1.3rem;
  cursor: pointer;
  display: grid;
  place-items: center;
  transition: all 150ms ease;
}

.shortcuts-modal__close:hover {
  background: var(--surface);
  color: var(--text);
  border-color: var(--border-light);
}

.shortcuts-modal__grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0;
  padding: 0;
}

.shortcuts-modal__group {
  padding: 20px 24px;
  border-bottom: 1px solid var(--border);
}

.shortcuts-modal__group:nth-child(odd) {
  border-right: 1px solid var(--border);
}

.shortcuts-modal__group:nth-last-child(-n+2) {
  border-bottom: none;
}

.shortcuts-modal__group h4 {
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--accent);
  margin-bottom: 12px;
}

.shortcuts-modal__item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 8px 0;
}

.shortcuts-modal__item span {
  font-size: 0.85rem;
  color: var(--text-secondary);
  flex: 1;
}

.shortcuts-modal__keys {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}

.shortcuts-modal__keys kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 32px;
  height: 28px;
  padding: 0 8px;
  background: var(--bg-2);
  border: 1px solid var(--border-light);
  border-bottom-width: 3px;
  border-radius: 6px;
  font-family: "Inter", system-ui, sans-serif;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.shortcuts-modal__plus {
  font-size: 0.7rem;
  color: var(--text-muted);
}

.shortcuts-modal__footer {
  padding: 14px 24px;
  border-top: 1px solid var(--border);
  background: var(--bg-2);
  text-align: center;
}

.shortcuts-modal__footer span {
  font-size: 0.8rem;
  color: var(--text-muted);
}

.shortcuts-modal__footer kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 22px;
  padding: 0 6px;
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-bottom-width: 2px;
  border-radius: 4px;
  font-family: "Inter", system-ui, sans-serif;
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--text-secondary);
  margin: 0 2px;
}

@media (max-width: 520px) {
  .shortcuts-modal__grid {
    grid-template-columns: 1fr;
  }

  .shortcuts-modal__group:nth-child(odd) {
    border-right: none;
  }

  .shortcuts-modal__group {
    border-bottom: 1px solid var(--border);
  }

  .shortcuts-modal__group:last-child {
    border-bottom: none;
  }
}

/* ==================== ENHANCED EMPTY STATES ==================== */
.empty-state-enhanced {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 48px 24px;
  text-align: center;
}

.empty-state-enhanced__illustration {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  display: grid;
  place-items: center;
  margin-bottom: 20px;
  position: relative;
}

.empty-state-enhanced__illustration--tasks {
  background: rgba(212, 184, 114, 0.1);
  border: 2px dashed rgba(212, 184, 114, 0.3);
}

.empty-state-enhanced__illustration--sessions {
  background: rgba(90, 158, 118, 0.1);
  border: 2px dashed rgba(90, 158, 118, 0.3);
}

.empty-state-enhanced__title {
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 8px;
}

.empty-state-enhanced__desc {
  font-size: 0.85rem;
  color: var(--text-muted);
  max-width: 280px;
  line-height: 1.5;
  margin-bottom: 16px;
}

.empty-state-enhanced__action {
  margin-top: 4px;
}

.empty-state-enhanced__illustration::after {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: 50%;
  border: 1px solid rgba(212, 184, 114, 0.2);
  animation: emptyPulseRing 3s ease-in-out infinite;
}

.empty-state-enhanced__illustration--sessions::after {
  border-color: rgba(90, 158, 118, 0.2);
}

@keyframes emptyPulseRing {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.08); opacity: 0.5; }
}

/* ==================== FOCUS MODE ENHANCEMENTS ==================== */
body.timer-running .nav-sidebar {
  opacity: 0.6;
  transition: opacity 400ms ease;
}

body.timer-running .nav-sidebar:hover {
  opacity: 1;
}

.nav-focus-dot {
  display: none;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #e57373;
  box-shadow: 0 0 6px rgba(229, 115, 115, 0.6);
  animation: focusDotPulse 1.5s ease-in-out infinite;
  flex-shrink: 0;
  margin-left: auto;
}

.nav-focus-dot.is-visible {
  display: block;
}

@keyframes focusDotPulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.4; transform: scale(0.75); }
}

/* ============================================================
   PWA INSTALL BANNER
   ============================================================ */
.pwa-install-banner {
  position: fixed;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%) translateY(120px);
  z-index: 9999;
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 16px;
  padding: 16px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  max-width: 520px;
  width: calc(100% - 32px);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(212, 184, 114, 0.1);
  opacity: 0;
  transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.4s ease;
  backdrop-filter: blur(12px);
}

.pwa-install-banner.is-visible {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

.pwa-install-banner__content {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 1;
  min-width: 0;
}

.pwa-install-banner__icon {
  font-size: 32px;
  flex-shrink: 0;
}

.pwa-install-banner__text {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
}

.pwa-install-banner__text strong {
  font-size: 14px;
  font-weight: 600;
  color: var(--text);
}

.pwa-install-banner__text span {
  font-size: 12px;
  color: var(--text-muted);
}

.pwa-install-banner__actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
}

/* ============================================================
   PWA UPDATE BANNER
   ============================================================ */
.pwa-update-banner {
  position: fixed;
  top: 16px;
  left: 50%;
  transform: translateX(-50%) translateY(-80px);
  z-index: 9999;
  background: var(--surface);
  border: 1px solid var(--accent);
  border-radius: 12px;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  max-width: 400px;
  width: calc(100% - 32px);
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(212, 184, 114, 0.15);
  opacity: 0;
  transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.4s ease;
}

.pwa-update-banner.is-visible {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

.pwa-update-banner__content {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  font-size: 14px;
  color: var(--text);
}

.pwa-update-banner__icon {
  font-size: 18px;
}

/* ============================================================
   OFFLINE INDICATOR
   ============================================================ */
.offline-indicator {
  position: fixed;
  top: 12px;
  right: 16px;
  z-index: 9998;
  background: #3d1a1a;
  border: 1px solid #6b2c2c;
  border-radius: 10px;
  padding: 8px 14px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  font-weight: 500;
  color: #f2ede4;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
  opacity: 0;
  transform: translateY(-20px);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.offline-indicator.is-visible {
  opacity: 1;
  transform: translateY(0);
}

.offline-indicator__icon {
  font-size: 14px;
  animation: offlinePulse 2s infinite;
}

.offline-indicator__text {
  white-space: nowrap;
}

@keyframes offlinePulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

/* ============================================================
   PWA RESPONSIVE ADJUSTMENTS
   ============================================================ */
@media (max-width: 480px) {
  .pwa-install-banner {
    flex-direction: column;
    align-items: stretch;
    bottom: 16px;
    padding: 14px 16px;
    gap: 12px;
  }

  .pwa-install-banner__actions {
    justify-content: flex-end;
  }

  .pwa-update-banner {
    top: 12px;
    max-width: calc(100% - 24px);
  }

  .offline-indicator {
    top: 8px;
    right: 8px;
    font-size: 12px;
    padding: 6px 10px;
  }
}

/* Standalone display mode adjustments */
@media (display-mode: standalone) {
  body {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  .offline-indicator {
    top: calc(12px + env(safe-area-inset-top));
  }

  .pwa-update-banner {
    top: calc(16px + env(safe-area-inset-top));
  }
}

/* ==================== THEME TOGGLE ==================== */

/* Theme toggle in sidebar */
.nav-theme-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin-top: 16px;
  padding: 10px 14px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
}

.nav-theme-toggle__label {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-weight: 500;
}

/* Sun/Moon toggle switch */
.theme-switch {
  position: relative;
  width: 56px;
  height: 28px;
  flex-shrink: 0;
}

.theme-switch input {
  opacity: 0;
  width: 0;
  height: 0;
  position: absolute;
}

.theme-switch__track {
  position: absolute;
  inset: 0;
  background: var(--border);
  border-radius: 999px;
  cursor: pointer;
  transition: background-color 250ms ease;
  overflow: hidden;
}

.theme-switch__track::before {
  content: "";
  position: absolute;
  inset: 2px;
  border-radius: 999px;
  background: var(--bg-2);
  transition: background-color 250ms ease;
}

.theme-switch__thumb {
  position: absolute;
  top: 3px;
  left: 3px;
  width: 22px;
  height: 22px;
  border-radius: 50%;
  background: var(--accent);
  transition: transform 250ms ease, background-color 250ms ease;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1;
  box-shadow: 0 1px 3px var(--shadow);
}

.theme-switch__icon {
  font-size: 0.7rem;
  line-height: 1;
  transition: opacity 200ms ease;
}

.theme-switch__icon--sun,
.theme-switch__icon--moon {
  position: absolute;
}

/* Dark mode state: show moon, hide sun */
[data-theme="dark"] .theme-switch__icon--moon { opacity: 1; }
[data-theme="dark"] .theme-switch__icon--sun { opacity: 0; }

/* Light mode state: show sun, hide moon */
[data-theme="light"] .theme-switch__icon--sun { opacity: 1; }
[data-theme="light"] .theme-switch__icon--moon { opacity: 0; }

/* Checked state (light mode) moves thumb right */
.theme-switch input:checked + .theme-switch__track .theme-switch__thumb {
  transform: translateX(28px);
}

.theme-switch input:checked + .theme-switch__track {
  background: var(--accent-2);
}

.theme-switch input:focus-visible + .theme-switch__track {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* Theme selector in settings (3-option: Dark / Auto / Light) */
.theme-selector {
  display: flex;
  gap: 8px;
}

.theme-selector__btn {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 10px 14px;
  border: 1px solid var(--border);
  border-radius: 10px;
  background: var(--bg-2);
  color: var(--text-muted);
  font-size: 0.8rem;
  font-weight: 500;
  font-family: inherit;
  cursor: pointer;
  transition: all 150ms ease;
}

.theme-selector__btn:hover {
  border-color: var(--border-light);
  color: var(--text);
}

.theme-selector__btn.is-active {
  border-color: var(--accent);
  background: rgba(212, 184, 114, 0.1);
  color: var(--accent);
}

[data-theme="light"] .theme-selector__btn.is-active {
  background: rgba(154, 123, 47, 0.1);
}

.theme-selector__icon {
  font-size: 1rem;
}

/* ==================== LIGHT THEME OVERRIDES ==================== */

[data-theme="light"] .home-action-card:hover { box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08); }
[data-theme="light"] .task-item.drag-ghost { box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15); }
[data-theme="light"] .block-color-btn:hover { box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12); }
[data-theme="light"] .block-color-popup { box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12); }
[data-theme="light"] .gantt-block { box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08); }
[data-theme="light"] .gantt-block:hover { box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15); }
[data-theme="light"] .block-list-grid .block-item:hover { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06); }

[data-theme="light"] .gantt-block__title,
[data-theme="light"] .gantt-block__time { text-shadow: 0 1px 2px rgba(0, 0, 0, 0.15); }

[data-theme="light"] .gantt-now-line {
  background: linear-gradient(180deg, var(--accent), rgba(154, 123, 47, 0.3));
  box-shadow: 0 0 6px rgba(154, 123, 47, 0.35);
}

[data-theme="light"] input[type="time"],
[data-theme="light"] input[type="date"] { color-scheme: light; }

[data-theme="light"] .task-add-input:focus { box-shadow: 0 0 0 3px rgba(154, 123, 47, 0.12); }
[data-theme="light"] .block-quick-time:focus,
[data-theme="light"] .block-quick-title:focus,
[data-theme="light"] .block-quick-duration:focus { box-shadow: 0 0 0 3px rgba(154, 123, 47, 0.12); }
[data-theme="light"] .btn:focus-visible { box-shadow: 0 0 0 4px rgba(154, 123, 47, 0.15); }

[data-theme="light"] .guide-section--highlight {
  background: linear-gradient(135deg, var(--surface), rgba(154, 123, 47, 0.06));
  border-color: rgba(154, 123, 47, 0.2);
}

[data-theme="light"] .analytics-card--streak {
  background: linear-gradient(135deg, var(--surface), rgba(229, 115, 115, 0.06));
  border-color: rgba(229, 115, 115, 0.15);
}

[data-theme="light"] .block-schedule-full::before,
[data-theme="light"] .timer-focus-panel::before { opacity: 0.6; }

[data-theme="light"] .home-action-card--primary {
  background: linear-gradient(135deg, var(--surface), rgba(154, 123, 47, 0.06));
  border-color: rgba(154, 123, 47, 0.2);
}

[data-theme="light"] .view-step-badge { background: rgba(154, 123, 47, 0.08); border-color: rgba(154, 123, 47, 0.2); }
[data-theme="light"] .view-step-badge--flow2 { background: rgba(58, 125, 84, 0.08); border-color: rgba(58, 125, 84, 0.2); }
[data-theme="light"] .view-step-badge--flow3 { background: rgba(200, 80, 80, 0.08); border-color: rgba(200, 80, 80, 0.2); }
[data-theme="light"] .view-step-badge--home { background: rgba(95, 122, 80, 0.08); border-color: rgba(95, 122, 80, 0.2); }
[data-theme="light"] .view-step-badge--analytics { background: rgba(120, 90, 180, 0.08); border-color: rgba(120, 90, 180, 0.2); }

[data-theme="light"] .toggle-chip--important:has(input:checked) { background: rgba(154, 123, 47, 0.1); box-shadow: 0 2px 8px rgba(154, 123, 47, 0.12); }
[data-theme="light"] .toggle-chip--urgent:has(input:checked) { background: rgba(158, 107, 50, 0.1); box-shadow: 0 2px 8px rgba(158, 107, 50, 0.12); }

[data-theme="light"] .task-item__badge--important { background: rgba(154, 123, 47, 0.1); }
[data-theme="light"] .task-item__badge--urgent { background: rgba(158, 107, 50, 0.1); }
[data-theme="light"] .task-item__badge--scheduled { background: rgba(58, 125, 84, 0.1); }

[data-theme="light"] .next-step-hint { background: rgba(58, 125, 84, 0.06); border-color: rgba(58, 125, 84, 0.18); }
[data-theme="light"] .timer-context-card { background: rgba(154, 123, 47, 0.06); border-color: rgba(154, 123, 47, 0.15); }
[data-theme="light"] .timer-work-option:hover { background: rgba(154, 123, 47, 0.04); }
[data-theme="light"] .timer-work-option.is-selected { background: rgba(154, 123, 47, 0.08); }
[data-theme="light"] .block-task-chip:hover { background: rgba(154, 123, 47, 0.04); }
[data-theme="light"] .block-task-chip--do { border-color: rgba(200, 80, 80, 0.3); background: rgba(200, 80, 80, 0.05); }
[data-theme="light"] .block-task-chip--schedule { border-color: rgba(154, 123, 47, 0.3); background: rgba(154, 123, 47, 0.05); }
[data-theme="light"] .task-list.drag-over { background: rgba(154, 123, 47, 0.06); }
[data-theme="light"] .matrix-quadrant.drag-over { background: rgba(154, 123, 47, 0.04); }

[data-theme="light"] .gantt-block--pending { background: linear-gradient(135deg, rgba(58, 125, 84, 0.85), rgba(58, 125, 84, 0.65)); }
[data-theme="light"] .gantt-block--in_progress { background: linear-gradient(135deg, var(--accent), rgba(154, 123, 47, 0.85)); }

[data-theme="light"] .block-status--in_progress { background: rgba(58, 125, 84, 0.12); }
[data-theme="light"] .block-status--completed { background: rgba(95, 122, 80, 0.1); }
[data-theme="light"] .block-status--missed { background: rgba(158, 107, 50, 0.12); }
[data-theme="light"] .block-status--upcoming { background: rgba(154, 123, 47, 0.12); }
[data-theme="light"] .block-status--now { background: rgba(200, 80, 80, 0.12); }

[data-theme="light"] .btn--accent { background: linear-gradient(135deg, var(--accent-2), rgba(58, 125, 84, 0.85)); color: #fff; }
[data-theme="light"] .btn--primary { color: #fff; }
[data-theme="light"] .btn--success { color: #fff; }
[data-theme="light"] .preset-btn.is-active { color: #fff; }
[data-theme="light"] .nav-badge { color: #fff; }
[data-theme="light"] .nav-item--flow.is-active .nav-step { color: #fff; }
[data-theme="light"] .nav-item--flow.is-done .nav-step { color: #fff; }

[data-theme="light"] .week-bar__fill { background: linear-gradient(180deg, var(--accent-2), var(--accent)); }

[data-theme="light"] .toast--success { border-color: rgba(58, 125, 84, 0.4); background: linear-gradient(135deg, var(--surface), rgba(58, 125, 84, 0.06)); }
[data-theme="light"] .toast--error { border-color: rgba(200, 80, 80, 0.4); background: linear-gradient(135deg, var(--surface), rgba(200, 80, 80, 0.06)); }
[data-theme="light"] .toast--warning { border-color: rgba(154, 123, 47, 0.4); background: linear-gradient(135deg, var(--surface), rgba(154, 123, 47, 0.06)); }
[data-theme="light"] .toast--info { border-color: rgba(59, 130, 246, 0.4); background: linear-gradient(135deg, var(--surface), rgba(59, 130, 246, 0.06)); }

[data-theme="light"] .modal__icon { background: rgba(58, 125, 84, 0.12); }
[data-theme="light"] .next-action-card { background: linear-gradient(135deg, var(--surface), rgba(154, 123, 47, 0.06)); border-color: rgba(154, 123, 47, 0.2); }
[data-theme="light"] .dash-card--highlight { border-color: rgba(154, 123, 47, 0.2); background: linear-gradient(135deg, var(--surface), rgba(154, 123, 47, 0.05)); }

[data-theme="light"] .guide-section--highlight { background: linear-gradient(135deg, var(--surface), rgba(154, 123, 47, 0.06)); border-color: rgba(154, 123, 47, 0.2); }
[data-theme="light"] .guide-tip { background: rgba(154, 123, 47, 0.07); }
[data-theme="light"] .guide-step__number { color: #fff; }
[data-theme="light"] .guide-shortcut kbd { background: var(--bg-2); border-color: var(--border); box-shadow: 0 2px 0 var(--border); }

[data-theme="light"] .matrix-quadrant--do .matrix-quadrant__badge { background: rgba(200, 80, 80, 0.1); color: #c85050; }
[data-theme="light"] .matrix-quadrant--schedule .matrix-quadrant__badge { background: rgba(154, 123, 47, 0.1); }
[data-theme="light"] .matrix-quadrant--delegate .matrix-quadrant__badge { background: rgba(158, 107, 50, 0.1); }

[data-theme="light"] .focus-now-btn { border-color: rgba(154, 123, 47, 0.3); background: rgba(154, 123, 47, 0.06); }
[data-theme="light"] .focus-now-btn:hover { background: var(--accent); color: #fff; }

[data-theme="light"] .block-btn--focus { border-color: rgba(200, 80, 80, 0.3); background: rgba(200, 80, 80, 0.06); }
[data-theme="light"] .block-btn--focus:hover { border-color: #c85050; background: rgba(200, 80, 80, 0.12); }

/* Light theme: block item tints */
[data-theme="light"] .block-item--green { background: linear-gradient(90deg, rgba(34, 197, 94, 0.06), transparent 50%); }
[data-theme="light"] .block-item--blue { background: linear-gradient(90deg, rgba(59, 130, 246, 0.06), transparent 50%); }
[data-theme="light"] .block-item--red { background: linear-gradient(90deg, rgba(239, 68, 68, 0.06), transparent 50%); }
[data-theme="light"] .block-item--orange { background: linear-gradient(90deg, rgba(249, 115, 22, 0.06), transparent 50%); }
[data-theme="light"] .block-item--purple { background: linear-gradient(90deg, rgba(168, 85, 247, 0.06), transparent 50%); }

[data-theme="light"] .block-color-btn.is-active { border-color: var(--text); box-shadow: 0 0 0 2px var(--bg-2); }

[data-theme="light"] .nav-credit__brand {
  background: linear-gradient(135deg, var(--accent), var(--accent-2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* =================================================================
   PREMIUM UX ENHANCEMENTS
   ================================================================= */

/* 1. SMOOTH SCROLL & MOMENTUM */
html { scroll-behavior: smooth; }
.main-content { scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
.block-tasks-horizontal { -webkit-overflow-scrolling: touch; scroll-snap-type: x proximity; }
.block-task-chip { scroll-snap-align: start; }

/* 2. BUTTON MICRO-INTERACTIONS */
.btn { position: relative; overflow: hidden; }
.btn--primary:hover { transform: translateY(-1px); box-shadow: 0 4px 16px rgba(212, 184, 114, 0.35); }
.btn--primary:active { transform: translateY(0) scale(0.97); box-shadow: 0 2px 8px rgba(212, 184, 114, 0.2); }
.btn--success:hover { transform: translateY(-1px); box-shadow: 0 4px 16px rgba(90, 158, 118, 0.35); }
.btn--success:active { transform: translateY(0) scale(0.97); }
.btn--ghost:hover { transform: translateY(-1px); }
.btn--ghost:active { transform: translateY(0) scale(0.97); }
.btn--large:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(212, 184, 114, 0.3); }
.btn--large:active { transform: translateY(0) scale(0.97); }
.btn::after { content: ""; position: absolute; inset: 0; background: radial-gradient(circle at var(--ripple-x, 50%) var(--ripple-y, 50%), rgba(255,255,255,0.2), transparent 60%); opacity: 0; transition: opacity 300ms ease; pointer-events: none; }
.btn:active::after { opacity: 1; transition: opacity 0ms; }

/* 2b. CARD HOVER LIFT */
.home-card { transition: all 250ms cubic-bezier(0.22, 1, 0.36, 1); }
.home-card:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(0,0,0,0.25); border-color: var(--border-light); }
.analytics-card { transition: all 250ms cubic-bezier(0.22, 1, 0.36, 1); }
.analytics-card:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(0,0,0,0.25); }
.settings-group { transition: all 250ms cubic-bezier(0.22, 1, 0.36, 1); }
.settings-group:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.15); }
.timer-work-option { transition: all 200ms cubic-bezier(0.22, 1, 0.36, 1); }
.timer-work-option:hover { transform: translateX(4px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }

/* 2c. CHECKBOX COMPLETION ANIMATION */
.task-item__checkbox { position: relative; appearance: none; -webkit-appearance: none; width: 22px; height: 22px; border: 2px solid var(--border-light); border-radius: 6px; background: transparent; cursor: pointer; transition: all 200ms cubic-bezier(0.22, 1, 0.36, 1); flex-shrink: 0; margin-top: 2px; }
.task-item__checkbox:hover { border-color: var(--accent-2); background: rgba(90, 158, 118, 0.08); }
.task-item__checkbox:checked { background: var(--accent-2); border-color: var(--accent-2); animation: checkboxPop 400ms cubic-bezier(0.22, 1, 0.36, 1); }
.task-item__checkbox:checked::after { content: ""; position: absolute; top: 3px; left: 6px; width: 5px; height: 10px; border: solid var(--bg); border-width: 0 2px 2px 0; transform: rotate(45deg); animation: checkmarkDraw 300ms ease 100ms both; }
@keyframes checkboxPop { 0% { transform: scale(1); } 30% { transform: scale(1.25); } 60% { transform: scale(0.9); } 100% { transform: scale(1); } }
@keyframes checkmarkDraw { from { clip-path: inset(0 0 100% 0); } to { clip-path: inset(0 0 0 0); } }
.task-item.is-done { opacity: 0.5; transition: opacity 400ms ease 200ms; }
.task-item.is-done .task-item__title { text-decoration: line-through; text-decoration-color: var(--accent-2); text-decoration-thickness: 2px; }
.task-item.is-completing { position: relative; }
.task-item.is-completing::before { content: ""; position: absolute; top: 50%; left: 16px; width: 8px; height: 8px; border-radius: 50%; background: var(--accent-2); animation: completionBurst 500ms cubic-bezier(0.22, 1, 0.36, 1) forwards; pointer-events: none; }
@keyframes completionBurst { 0% { transform: scale(0); opacity: 1; } 50% { transform: scale(1); opacity: 0.8; box-shadow: 0 0 0 4px rgba(90,158,118,0.3), 0 0 0 8px rgba(90,158,118,0.1); } 100% { transform: scale(1.5); opacity: 0; box-shadow: 0 0 0 12px rgba(90,158,118,0), 0 0 0 20px rgba(90,158,118,0); } }

/* 2d. TASK DELETION SLIDE-OUT */
.task-item.is-removing { animation: taskSlideOut 350ms cubic-bezier(0.4, 0, 1, 1) forwards; pointer-events: none; }
@keyframes taskSlideOut { 0% { opacity: 1; transform: translateX(0) scale(1); max-height: 100px; } 50% { opacity: 0.5; transform: translateX(60px) scale(0.95); } 100% { opacity: 0; transform: translateX(120px) scale(0.9); max-height: 0; padding-top: 0; padding-bottom: 0; margin-bottom: 0; border-width: 0; overflow: hidden; } }

/* 3. LOADING SKELETON SHIMMER */
@keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
.skeleton { background: linear-gradient(90deg, var(--surface) 25%, var(--surface-2, rgba(255,255,255,0.05)) 37%, var(--surface) 63%); background-size: 200% 100%; animation: shimmer 1.5s ease-in-out infinite; border-radius: 8px; }
.skeleton-text { height: 14px; margin-bottom: 8px; border-radius: 6px; }
.skeleton-text--short { width: 60%; }
.skeleton-text--medium { width: 80%; }
.skeleton-title { height: 24px; width: 40%; margin-bottom: 12px; border-radius: 8px; }
.skeleton-card { padding: 20px; background: var(--surface); border: 1px solid var(--border); border-radius: 14px; min-height: 120px; }
.skeleton-ring { width: 120px; height: 120px; border-radius: 50%; margin: 0 auto 12px; }
.skeleton-wrapper { transition: opacity 300ms ease; }
.skeleton-wrapper.is-loaded { opacity: 0; pointer-events: none; position: absolute; }

/* 4. SMOOTH PROGRESS ANIMATIONS */
.timer-ring__progress.is-running { filter: drop-shadow(0 0 6px rgba(90,158,118,0.4)); }
.timer-ring__progress.is-break { filter: drop-shadow(0 0 6px rgba(212,184,114,0.4)); }
.timer-display { transition: color 300ms ease; font-variant-numeric: tabular-nums; }
.timer-mode-switching .timer-display { animation: timerModePulse 400ms ease; }
@keyframes timerModePulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); opacity: 0.7; } 100% { transform: scale(1); opacity: 1; } }
.week-bar__fill.animate-in { animation: barGrow 600ms cubic-bezier(0.22, 1, 0.36, 1) backwards; }
@keyframes barGrow { from { height: 0 !important; min-height: 0; } }

/* 5. ENHANCED DRAG FEEDBACK */
.task-item.drag-ghost { position: fixed; pointer-events: none; z-index: 1000; opacity: 0.92; transform: rotate(2deg) scale(1.04); box-shadow: 0 12px 36px rgba(0,0,0,0.45), 0 0 0 1px rgba(212,184,114,0.3); border-color: var(--accent); background: var(--surface); transition: none; }
.task-item.is-dragging { opacity: 0.3; cursor: grabbing; transform: scale(0.97); border-style: dashed; border-color: var(--border-light); }
.matrix-quadrant { transition: all 250ms cubic-bezier(0.22, 1, 0.36, 1); position: relative; }
.matrix-quadrant.drag-over { border-color: var(--accent) !important; background: rgba(212,184,114,0.06); transform: scale(1.01); box-shadow: 0 0 0 3px rgba(212,184,114,0.15), 0 8px 24px rgba(0,0,0,0.15); }
.matrix-quadrant.drag-over::after { content: "Tha vao day"; position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); padding: 8px 20px; background: var(--accent); color: var(--bg); border-radius: 999px; font-size: 0.75rem; font-weight: 600; pointer-events: none; animation: dropHintBounce 600ms cubic-bezier(0.22,1,0.36,1); box-shadow: 0 4px 12px rgba(212,184,114,0.3); z-index: 5; }
@keyframes dropHintBounce { 0% { opacity: 0; transform: translateX(-50%) translateY(8px); } 50% { opacity: 1; transform: translateX(-50%) translateY(-2px); } 100% { opacity: 1; transform: translateX(-50%) translateY(0); } }
.matrix-quadrant.drag-over::before { content: ""; position: absolute; inset: -2px; border-radius: 16px; border: 2px solid var(--accent); animation: dropZonePulse 1.2s ease-in-out infinite; pointer-events: none; z-index: 1; }
@keyframes dropZonePulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.8; } }

/* 6. PARALLAX ON DASHBOARD HEADER */
.view-header--home { position: relative; overflow: hidden; }
.view-header--home::before { content: ""; position: absolute; top: -50%; right: -20%; width: 300px; height: 300px; background: radial-gradient(circle, rgba(212,184,114,0.08), transparent 70%); border-radius: 50%; pointer-events: none; transition: transform 200ms ease-out; will-change: transform; }
.view-header--home::after { content: ""; position: absolute; bottom: -60%; left: -10%; width: 200px; height: 200px; background: radial-gradient(circle, rgba(90,158,118,0.06), transparent 70%); border-radius: 50%; pointer-events: none; transition: transform 200ms ease-out; will-change: transform; }

/* 7. CONFETTI / CELEBRATION */
.celebration-container { position: fixed; inset: 0; pointer-events: none; z-index: 3000; overflow: hidden; }
.confetti-particle { position: absolute; width: 10px; height: 10px; border-radius: 2px; top: -10px; animation: confettiFall var(--fall-duration, 3s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; will-change: transform; }
.confetti-particle:nth-child(odd) { border-radius: 50%; }
.confetti-particle:nth-child(3n) { width: 6px; height: 14px; border-radius: 3px; }
@keyframes confettiFall { 0% { transform: translateY(0) rotate(0deg) scale(1); opacity: 1; } 20% { opacity: 1; } 100% { transform: translateY(100vh) rotate(var(--rotation, 720deg)) scale(0.3); opacity: 0; } }
.celebration-text { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 3001; pointer-events: none; text-align: center; animation: celebrationTextPop 2.5s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
.celebration-text__emoji { font-size: 3rem; display: block; animation: celebrationEmojiBounce 600ms cubic-bezier(0.22, 1, 0.36, 1); }
.celebration-text__message { font-size: 1.5rem; font-weight: 700; color: var(--accent); text-shadow: 0 2px 12px rgba(212,184,114,0.3); margin-top: 8px; display: block; }
@keyframes celebrationTextPop { 0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } 15% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); } 30% { transform: translate(-50%, -50%) scale(1); } 80% { opacity: 1; } 100% { opacity: 0; transform: translate(-50%, -60%) scale(0.95); } }
@keyframes celebrationEmojiBounce { 0% { transform: scale(0) rotate(-20deg); } 50% { transform: scale(1.3) rotate(5deg); } 70% { transform: scale(0.9) rotate(-3deg); } 100% { transform: scale(1) rotate(0); } }

/* STAGGERED LIST ANIMATIONS */
.task-item { animation: listItemEnter 300ms cubic-bezier(0.22, 1, 0.36, 1) backwards; }
.task-list .task-item:nth-child(1) { animation-delay: 0ms; }
.task-list .task-item:nth-child(2) { animation-delay: 40ms; }
.task-list .task-item:nth-child(3) { animation-delay: 80ms; }
.task-list .task-item:nth-child(4) { animation-delay: 120ms; }
.task-list .task-item:nth-child(5) { animation-delay: 160ms; }
.task-list .task-item:nth-child(6) { animation-delay: 200ms; }
.task-list .task-item:nth-child(n+7) { animation-delay: 240ms; }
@keyframes listItemEnter { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.block-list-grid .block-item { animation: blockItemEnter 300ms cubic-bezier(0.22, 1, 0.36, 1) backwards; }
.block-list-grid .block-item:nth-child(1) { animation-delay: 0ms; }
.block-list-grid .block-item:nth-child(2) { animation-delay: 60ms; }
.block-list-grid .block-item:nth-child(3) { animation-delay: 120ms; }
.block-list-grid .block-item:nth-child(4) { animation-delay: 180ms; }
.block-list-grid .block-item:nth-child(n+5) { animation-delay: 240ms; }
@keyframes blockItemEnter { from { opacity: 0; transform: translateY(12px) scale(0.97); } to { opacity: 1; transform: translateY(0) scale(1); } }

/* NAV & PRESET MICRO-INTERACTIONS */
.nav-item { transition: all 200ms cubic-bezier(0.22, 1, 0.36, 1); }
.nav-item:hover { transform: translateX(4px); }
.nav-item:active { transform: translateX(2px) scale(0.98); }
.nav-item.is-active { transform: translateX(0); }
.preset-btn { transition: all 200ms cubic-bezier(0.22, 1, 0.36, 1); }
.preset-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
.preset-btn:active { transform: translateY(0) scale(0.95); }
.preset-btn.is-active { box-shadow: 0 2px 12px rgba(212,184,114,0.3); }

/* TOGGLE CHIP ANIMATION */
.toggle-chip { transition: all 250ms cubic-bezier(0.22, 1, 0.36, 1); }
.toggle-chip:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
.toggle-chip:active { transform: translateY(0) scale(0.97); }

/* MODAL ENHANCED */
.modal__backdrop { animation: backdropFadeIn 200ms ease forwards; }
@keyframes backdropFadeIn { from { opacity: 0; } to { opacity: 1; } }
.modal__content { animation: modalSlideIn 350ms cubic-bezier(0.22, 1, 0.36, 1) forwards; }
@keyframes modalSlideIn { from { opacity: 0; transform: scale(0.9) translateY(20px); } to { opacity: 1; transform: scale(1) translateY(0); } }

/* REDUCED MOTION */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
  html { scroll-behavior: auto; }
  .confetti-particle, .celebration-text, .celebration-container { display: none !important; }
}
